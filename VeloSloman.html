<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Фиксация поломок велосипедов</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary-bg: #000;
            --primary-text: #fff;
            --border-color: #fff;
            --border-radius: 12px;
            --border-radius-small: 8px;
            --border-width: 1px;
            --transition: all 0.3s ease;
        }

        @font-face {
            font-family: 'Moscow Sans';
            src: url('fonts/MOSCOWSANSREGULAR.woff2') format('woff2'),
                url('fonts/MOSCOWSANSREGULAR.TTF') format('truetype');
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Moscow Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.3);
        }

        body {
            background-color: var(--primary-bg);
            color: var(--primary-text);
            min-height: 100vh;
            padding: 20px 12px 80px;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 15px;
            overflow-x: hidden;
            box-sizing: border-box;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 28px;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .page-description {
            font-size: 16px;
            color: #ccc;
            line-height: 1.4;
        }

        .input-section {
            margin-bottom: 30px;
        }

        .input-label {
            display: block;
            font-size: 16px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .input-wrapper {
            display: flex;
            gap: 10px;
            align-items: stretch;
            flex-wrap: nowrap;
        }

        .bike-input {
            flex: 1;
            min-width: 0;
            height: 50px;
            border: var(--border-width) solid var(--border-color);
            border-radius: var(--border-radius);
            background: transparent;
            color: var(--primary-text);
            padding: 0 15px;
            font-size: 16px;
            transition: var(--transition);
            box-sizing: border-box;
            }

        .bike-input:focus {
            outline: none;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .validate-btn {
            height: 50px;
            padding: 0 20px;
            border: var(--border-width) solid var(--border-color);
            border-radius: var(--border-radius);
            background: transparent;
            color: var(--primary-text);
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
            flex-shrink: 0;
            box-sizing: border-box;
        }

        .validate-btn:active {
            transform: scale(0.98);
        }

        .bike-section {
            margin-bottom: 30px;
            position: relative;
        }

        .bike-container {
            width: 100%;
            border: var(--border-width) solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 10px;
            background: #3A3A3A;
            overflow: hidden;
            position: relative;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .bike-svg {
            width: 100% !important;
            height: auto !important;
            max-width: 100% !important;
            display: block;
            margin: 0 auto;
        }

        .bike-part {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        @media (max-width: 768px) {
            .bike-svg {
                max-width: 450px;
            }
        }

        @media (max-width: 480px) {
            .bike-container {
                min-height: 250px;
                padding: 10px;
            }
            
            .bike-svg {
                max-width: 400px;
            }
        }

        @media (max-width: 400px) {
            .bike-svg {
                max-width: 350px;
            }
        }

        @media (max-width: 360px) {
            .bike-container {
                min-height: 220px;
            }
            
            .bike-svg {
                max-width: 320px;
            }
        }

        @media (max-width: 320px) {
            .bike-svg {
                max-width: 280px;
            }
        }

        .bike-part.active {
            filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.6));
            animation: pulse-glow 0.3s ease-out;
        }

        @keyframes pulse-glow {
            0% {
                filter: drop-shadow(0 0 0px rgba(255, 255, 255, 0));
            }
            50% {
                filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.8));
            }
            100% {
                filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.6));
            }
        }

        .damage-dropdown {
            position: fixed;
            background: #1a1a1a;
            border: 2px solid #fff;
            border-radius: 12px;
            padding: 8px 0;
            z-index: 1000;
            max-height: 200px;
            overflow-y: auto;
            display: none;
            animation: fadeIn 0.2s ease;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }

        .damage-option {
            padding: 12px 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .damage-option:last-child {
            border-bottom: none;
        }

        .damage-option:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .damage-dropdown::-webkit-scrollbar {
            width: 6px;
        }

        .damage-dropdown::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .damage-dropdown::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .selected-damages {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 20px;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .damages-list {
            border: var(--border-width) solid var(--border-color);
            border-radius: var(--border-radius);
            min-height: 100px;
            padding: 15px;
        }

        .damage-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            animation: slideIn 0.3s ease;
        }

        .damage-item:last-child {
            border-bottom: none;
        }

        .damage-info {
            flex: 1;
        }

        .damage-part {
            font-size: 12px;
            color: #ccc;
            margin-bottom: 3px;
        }

        .damage-description {
            font-size: 14px;
            font-weight: bold;
        }

        .remove-damage {
            background: none;
            border: none;
            color: #ff4444;
            font-size: 18px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

        .remove-damage:active {
            background: rgba(255, 68, 68, 0.2);
        }

        .empty-damages {
            text-align: center;
            color: #ccc;
            font-size: 14px;
            padding: 30px 0;
        }

        .submit-section {
            text-align: center;
        }

        .submit-btn {
            height: 50px;
            padding: 0 40px;
            background: var(--primary-text);
            color: var(--primary-bg);
            border: none;
            border-radius: var(--border-radius);
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .submit-btn:active:not(:disabled) {
            transform: scale(0.98);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal.fade-out {
            animation: fadeOut 0.3s ease forwards;
        }

        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(10px); }
        }

        .modal-content {
            background: var(--primary-bg);
            border: var(--border-width) solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 20px;
            max-width: 400px;
            width: 90%;
            position: relative;
            animation: scaleIn 0.3s ease;
        }

        @keyframes scaleIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-close {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

        .modal-close:active {
            background: rgba(255, 255, 255, 0.1);
        }

        .modal-title {
            font-size: 20px;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .modal-text {
            font-size: 16px;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .modal-btn {
            display: block;
            font-weight: bold;
            width: 100%;
            height: 40px;
            background: var(--primary-text);
            color: var(--primary-bg);
            border: none;
            border-radius: var(--border-radius);
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-btn:active {
            transform: scale(0.98);
        }

        .notification {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.95);
            color: #000;
            padding: 10px 20px;
            border-radius: 8px;
            z-index: 1000;
            transition: all 0.3s ease;
            transform: translateX(100%);
            opacity: 0;
            font-size: 14px;
            font-weight: bold;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .error-message {
            color: #ff4444;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="page-title">Фиксация поломок</h1>
            <p class="page-description">Введите номер велосипеда и выберите поврежденные детали</p>
        </div>

        <div class="input-section">
            <label class="input-label">Номер велосипеда</label>
            <div class="input-wrapper">
                <input type="text" class="bike-input" id="bike-number" placeholder="20000-29030" maxlength="5">
                <button class="validate-btn" id="validate-btn">Проверить</button>
            </div>
            <div class="error-message" id="number-error">Номер должен быть от 20000 до 29030</div>
        </div>

        <div class="bike-section">
            <div class="bike-container">
                <!-- SVG велосипеда будет вставлено здесь -->
                <div id="bike-svg-container"></div>
            </div>
            <div class="damage-dropdown" id="damage-dropdown"></div>
        </div>

        <div class="selected-damages">
            <h2 class="section-title">Выбранные поломки</h2>
            <div class="damages-list" id="damages-list">
                <div class="empty-damages">Поломки не выбраны</div>
            </div>
        </div>

        <div class="submit-section">
            <button class="submit-btn" id="submit-btn" disabled>Отправить заявку</button>
        </div>
    </div>

    <!-- Модальное окно подтверждения -->
    <div class="modal" id="confirmation-modal">
        <div class="modal-content">
            <span class="modal-close" id="modal-close">&times;</span>
            <h2 class="modal-title">Заявка отправлена</h2>
            <p class="modal-text">Заявка на велосипед №<span id="bike-number-confirm"></span> успешно отправлена администратору.</p>
            <button class="modal-btn" id="modal-ok-btn">Хорошо</button>
        </div>
    </div>

    <!-- Уведомление -->
    <div class="notification" id="notification"></div>

    <script>
        let currentBikeNumber = '';
        let selectedDamages = [];
        let currentPart = null;
        let telegramWebApp = null;
        let damageData = {};

        // Инициализация Telegram Web App
        function initTelegramWebApp() {
            if (window.Telegram && window.Telegram.WebApp) {
                telegramWebApp = window.Telegram.WebApp;
                telegramWebApp.ready();
                telegramWebApp.expand();
            }
        }

        async function loadDamageData() {
            try {
                const response = await fetch('damages.json');
                const data = await response.json();
                damageData = data.parts;
                console.log('Данные о поломках загружены');
            } catch (error) {
                console.error('Ошибка загрузки данных о поломках:', error);
                // Fallback данные на случай ошибки
                damageData = {
                    "rear-wheel": ["Прокол колеса", "Восьмерка на колесе", "Износ покрышки"],
                    "front-wheel": ["Прокол колеса", "Восьмерка на колесе", "Износ покрышки"],
                    // ... остальные детали
                };
            }
        }

        function resizeBikeSVG() {
            const svg = document.querySelector('.bike-svg');
            const container = document.querySelector('.bike-container');
            
            if (svg && container) {
                const containerWidth = container.clientWidth;
                const svgNaturalWidth = 525; // Оригинальная ширина SVG
                
                // Рассчитываем масштаб
                const scale = Math.min(1, (containerWidth - 40) / svgNaturalWidth);
                
                // Применяем трансформацию
                svg.style.transform = `scale(${scale})`;
                svg.style.transformOrigin = 'center';
            }
        }

        // Вызываем при загрузке и ресайзе
        window.addEventListener('load', resizeBikeSVG);
        window.addEventListener('resize', resizeBikeSVG);

        // Загрузка SVG велосипеда
        function loadBikeSVG() {
            const svgContainer = document.getElementById('bike-svg-container');
            // В реальном приложении здесь будет загрузка SVG файла
            // Для демонстрации создаем заглушку
            svgContainer.innerHTML = `
            <svg width="355" height="263" viewBox="0 0 355 263" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_586_2)">

 <!-- Заднее колесо -->
<g id="rear-wheel" class="bike-part">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M69.448 256.963C105.041 256.963 133.896 228.147 133.896 192.599C133.896 157.052 105.041 128.235 69.448 128.235C33.8543 128.235 5 157.052 5 192.599C5 228.147 33.8543 256.963 69.448 256.963ZM69.448 246.91C99.482 246.91 123.829 222.594 123.829 192.599C123.829 162.604 99.482 138.289 69.448 138.289C39.414 138.289 15.0667 162.604 15.0667 192.599C15.0667 222.594 39.414 246.91 69.448 246.91Z" fill="black"/>
    <path d="M69.4493 203.48C75.4676 203.48 80.3463 198.608 80.3463 192.598C80.3463 186.587 75.4676 181.715 69.4493 181.715C63.4311 181.715 58.5523 186.587 58.5523 192.598C58.5523 198.608 63.4311 203.48 69.4493 203.48Z" fill="black"/>
    <path d="M55.1162 245.059L66.7393 202.979" stroke="black"/>
    <path d="M72.578 202.386L80.4653 245.918" stroke="black"/>
    <path d="M100.635 237.803L76.7426 200.343" stroke="black"/>
    <path d="M79.2287 196.977L117.638 219.012" stroke="black"/>
    <path d="M17.7537 174.76L60.3661 187.021" stroke="black"/>
    <path d="M59.4464 193.231L14.9767 195.109" stroke="black"/>
    <path d="M19.3788 216.039L59.8521 197.634" stroke="black"/>
    <path d="M62.8464 200.562L35.6416 235.474" stroke="black"/>
    <path d="M85.984 140.299L72.776 183.057" stroke="black"/>
    <path d="M67.19 182.406L60.6727 138.65" stroke="black"/>
    <path d="M40.2592 146.13L62.9644 184.319" stroke="black"/>
    <path d="M60.3745 187.608L22.6754 164.381" stroke="black"/>
    <path d="M121.117 211.731L78.7853 197.372" stroke="black"/>
    <path d="M80.03 191.967L124.325 191.624" stroke="black"/>
    <path d="M120.793 170.425L78.8133 188.034" stroke="black"/>
    <path d="M76.354 184.817L105.15 150.488" stroke="black"/>
    <path d="M91.252 242.66L74.0706 202.522" stroke="black"/>
    <path d="M78.2653 198.421L111.607 227.546" stroke="black"/>
    <path d="M122.312 208.641L79.8227 194.052" stroke="black"/>
    <path d="M79.2607 189.679L123.876 183.363" stroke="black"/>
    <path d="M18.1563 210.96L59.1274 194.014" stroke="black"/>
    <path d="M62.2816 199.439L28.7549 228.351" stroke="black"/>
    <path d="M69.5153 203.053L70.04 247.289" stroke="black"/>
    <path d="M49.9883 141.536L65.9191 183.049" stroke="black"/>
    <path d="M61.5788 186.156L29.1673 156.002" stroke="black"/>
    <path d="M17.8745 174.561L59.4667 190.282" stroke="black"/>
    <path d="M59.4957 194.462L15.5205 199.775" stroke="black"/>
    <path d="M124.301 196.143L80.1147 193.035" stroke="black"/>
    <path d="M122.05 175.504L79.422 191.15" stroke="black"/>
    <path d="M77.5873 185.636L112.005 157.787" stroke="black"/>
    <path d="M96.01 143.411L74.2033 183.326" stroke="black"/>
    <path d="M70.4687 181.797L71.3333 137.567" stroke="black"/>
    <path d="M64.8347 246.861L68.7587 203.385" stroke="black"/>
    <path d="M108.329 231.614L78.132 199.009" stroke="black"/>
    <path d="M15.5207 184.344L59.6393 188.82" stroke="black"/>
    <path d="M15.0025 187.192L59.0442 192.368" stroke="black"/>
    <path d="M24.4897 224.667L61.0284 199.349" stroke="black"/>
    <path d="M64.4958 201.698L43.9602 240.895" stroke="black"/>
    <path d="M76.5053 138.285L70.9207 182.381" stroke="black"/>
    <path d="M32.5525 152.159L61.712 185.693" stroke="black"/>
    <path d="M123.826 202.31L79.4633 195.519" stroke="black"/>
    <path d="M116.134 161.726L77.412 186.764" stroke="black"/>
</g>

<!-- Переднее колесо -->
<g id="front-wheel" class="bike-part">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M285.115 256.963C320.708 256.963 349.563 228.147 349.563 192.599C349.563 157.052 320.708 128.235 285.115 128.235C249.521 128.235 220.667 157.052 220.667 192.599C220.667 228.147 249.521 256.963 285.115 256.963ZM285.115 246.91C315.149 246.91 339.496 222.594 339.496 192.599C339.496 162.604 315.149 138.289 285.115 138.289C255.081 138.289 230.733 162.604 230.733 192.599C230.733 222.594 255.081 246.91 285.115 246.91Z" fill="black"/>
    <path d="M270.783 245.059L282.406 202.979" stroke="black"/>
    <path d="M288.245 202.386L296.132 245.918" stroke="black"/>
    <path d="M316.302 237.803L292.409 200.343" stroke="black"/>
    <path d="M294.895 196.977L333.305 219.012" stroke="black"/>
    <path d="M233.421 174.76L276.033 187.021" stroke="black"/>
    <path d="M275.113 193.231L230.643 195.109" stroke="black"/>
    <path d="M235.045 216.039L275.519 197.634" stroke="black"/>
    <path d="M278.513 200.562L251.308 235.474" stroke="black"/>
    <path d="M301.651 140.299L288.443 183.057" stroke="black"/>
    <path d="M282.857 182.406L276.339 138.65" stroke="black"/>
    <path d="M255.926 146.13L278.631 184.319" stroke="black"/>
    <path d="M276.041 187.608L238.342 164.381" stroke="black"/>
    <path d="M336.783 211.731L294.452 197.372" stroke="black"/>
    <path d="M295.697 191.967L339.991 191.624" stroke="black"/>
    <path d="M336.46 170.425L294.48 188.034" stroke="black"/>
    <path d="M292.021 184.817L320.817 150.488" stroke="black"/>
    <path d="M306.919 242.66L289.737 202.522" stroke="black"/>
    <path d="M293.932 198.421L327.274 227.546" stroke="black"/>
    <path d="M337.979 208.641L295.489 194.052" stroke="black"/>
    <path d="M294.927 189.679L339.543 183.363" stroke="black"/>
    <path d="M233.823 210.96L274.794 194.014" stroke="black"/>
    <path d="M277.948 199.439L244.421 228.351" stroke="black"/>
    <path d="M285.182 203.053L285.707 247.289" stroke="black"/>
    <path d="M265.655 141.536L281.586 183.049" stroke="black"/>
    <path d="M277.245 186.156L244.834 156.002" stroke="black"/>
    <path d="M233.541 174.561L275.133 190.282" stroke="black"/>
    <path d="M275.163 194.462L231.187 199.775" stroke="black"/>
    <path d="M339.967 196.143L295.781 193.035" stroke="black"/>
    <path d="M337.717 175.504L295.089 191.15" stroke="black"/>
    <path d="M293.254 185.636L327.671 157.787" stroke="black"/>
    <path d="M311.677 143.411L289.87 183.326" stroke="black"/>
    <path d="M286.135 181.797L287 137.567" stroke="black"/>
    <path d="M280.501 246.861L284.425 203.385" stroke="black"/>
    <path d="M323.996 231.614L293.799 199.009" stroke="black"/>
    <path d="M231.187 184.344L275.306 188.82" stroke="black"/>
    <path d="M230.669 187.192L274.711 192.368" stroke="black"/>
    <path d="M240.157 224.667L276.695 199.349" stroke="black"/>
    <path d="M280.163 201.698L259.627 240.895" stroke="black"/>
    <path d="M292.172 138.285L286.587 182.381" stroke="black"/>
    <path d="M248.219 152.159L277.379 185.693" stroke="black"/>
    <path d="M339.493 202.31L295.13 195.519" stroke="black"/>
    <path d="M331.801 161.726L293.079 186.764" stroke="black"/>
</g>

<!-- Мотор-колесос -->
<g id="motor" class="bike-part">
    <path d="M285.116 202.815C290.766 202.815 295.346 198.24 295.346 192.598C295.346 186.955 290.766 182.38 285.116 182.38C279.466 182.38 274.886 186.955 274.886 192.598C274.886 198.24 279.466 202.815 285.116 202.815Z" fill="#E4E5DC" stroke="#C4B1AB" stroke-width="2"/>
</g>

<!-- Задний рекламный щит -->
<g id="rear-ad-sign" class="bike-part">
    <path d="M135 191.484H138.667C138.667 184.494 136.4 167.651 127.333 156.199C116 141.884 101 128.234 68.6667 127.236C42.8 126.437 23.4445 142.882 17 151.205H12C10.1333 155.732 4.77778 159.749 2.33333 161.192L0 184.826C12.3333 183.162 25.3333 185.159 32 184.826C38.6667 184.493 51.3333 179.169 57 175.507C62 172.276 69.1113 172.289 72.3333 172.511C76 172.763 85.7787 176.84 88.6667 181.166C91.8667 185.96 97.3333 183.606 99.6667 184.826C123.933 185.093 133.333 189.376 135 191.484Z" fill="black"/>
</g>

<!-- Передний рекламный щит -->
<g id="front-ad-sign" class="bike-part">
    <path d="M294.381 123.907L291.048 129.566C275.848 127.435 263.381 134.005 259.048 137.556L254.048 140.219L263.381 159.861L258.381 163.855C256.381 164.188 251.715 175.174 251.715 178.503C251.715 181.832 244.715 194.482 235.715 194.815C228.515 195.082 220.937 198.477 218.048 200.142C217.715 189.822 219.048 178.17 224.048 163.855C229.397 148.542 240.333 138.888 256.381 130.232C269.267 123.281 286.826 122.686 294.381 123.907Z" fill="black" stroke="black"/>
</g>

<!-- Замок велосипеда -->
<g id="lock" class="bike-part">
    <path d="M121.109 125.074L96.442 155.368C96.1086 155.147 95.242 154.503 94.442 153.704C93.642 152.905 94.1086 151.596 94.442 151.041L105.775 135.394L103.775 133.397C106.442 130.29 112.042 123.743 113.109 122.411C114.175 121.08 116.442 121.635 117.442 122.078L121.109 125.074Z" fill="#2A2A2A"/>
</g>

<!-- Рама велосипеда -->
<g id="frame" class="bike-part">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M183.661 194.482C184.328 197.589 183.595 203.804 175.328 203.804H163.328C161.661 203.804 158.128 203.404 157.328 201.806L130.328 203.138H96.9947L90.328 202.139H73.328L69.9947 198.477L63.3283 197.479L62.6616 191.486L71.9947 184.162L124.661 118.914L129.328 115.252L152.328 169.848C153.217 171.623 155.728 175.174 158.661 175.174H175.328L180.995 168.183C182.551 169.625 186.395 171.579 189.328 167.85C192.261 164.122 214.551 133.894 225.328 119.247C226.217 118.137 226.995 115.185 222.995 112.256L233.661 97.6081C234.217 96.8311 234.728 94.2125 232.328 89.9513L240.661 85.6236L264.328 139.221L284.328 181.832C282.773 181.832 279.995 182.498 276.995 185.494C269.661 173.177 262.328 158.529 254.995 144.214C251.959 138.287 244.551 121.244 240.661 113.587L183.661 194.482ZM75.6613 186.493L125.328 131.897L149.328 187.159C147.461 187.159 147.328 192.818 147.328 196.147C126.995 196.257 84.6613 196.413 77.9947 196.147C71.328 195.881 73.6613 189.599 75.6613 186.493Z" fill="#F17217"/>
    <path d="M63.3283 197.479L62.6616 191.486C61.6667 192.152 60.8759 193.151 60.9949 194.15C61.2491 196.281 62.6616 197.256 63.3283 197.479Z" fill="#F17217"/>
    <path d="M288.873 191.486L284.333 181.832C281.667 181.832 278.667 183.164 277 185.494L284.117 195.148C288.206 197.811 290.206 195.481 288.873 191.486Z" fill="#282428"/>
    <path d="M158.667 216.121C158.667 216.121 90.674 208.268 67.3333 202.805" stroke="#949494" stroke-linecap="square"/>
    <path d="M183.667 193.935C179.667 190.822 177 183.099 153.333 187.476" stroke="#AC5313" stroke-linecap="square"/>
</g>

<!-- Световой маркер -->
<g id="light-marker" class="bike-part">
    <path d="M76.3333 183.164L72.6653 180.09C71.998 179.425 69.7513 178.674 68.332 180.09C66.998 181.421 66.0005 182.642 65.0005 183.752C64.445 184.307 63.6672 185.683 65.0005 186.748C66.3339 187.814 67.6667 188.712 69 189.822" stroke="#F17217" stroke-width="2" stroke-linecap="round"/>
    <path d="M68.878 182.144C69.8767 181.144 72.2114 182.144 72.2114 182.144C72.2114 182.144 70.21 185.139 68.878 187.137C67.5467 189.135 67.88 183.143 68.878 182.144Z" fill="#980000"/>
    <path d="M72.2099 182.002L67.7709 187.098C67.5292 187.376 67.5585 187.796 67.8363 188.038L68.7151 188.801C68.9929 189.042 69.414 189.013 69.6557 188.736L74.0947 183.639C74.3364 183.362 74.3071 182.941 74.0293 182.7L73.1505 181.936C72.8727 181.695 72.4516 181.724 72.2099 182.002Z" fill="#515151"/>
</g>

<!-- Батарея -->
<g id="battery" class="bike-part">
    <path d="M223 112.256L181 168.115C184.733 171.311 187.903 169.78 189.333 167.85C200.111 153.313 222.333 123.375 225 119.912C227.667 116.45 224.778 113.365 223 112.256Z" fill="black"/>
</g>

<!-- Визуальные элементы на раме -->
<g class="bike-part">
    <path d="M202.92 162.373L198.013 158.811L199.225 157.145C199.561 156.683 199.949 156.425 200.387 156.373C200.829 156.315 201.197 156.393 201.491 156.607C201.697 156.756 201.851 156.942 201.953 157.166C202.049 157.386 202.088 157.603 202.068 157.817L202.082 157.827C202.373 157.604 202.701 157.477 203.065 157.449C203.423 157.417 203.771 157.523 204.107 157.767C204.486 158.042 204.711 158.43 204.782 158.931C204.849 159.429 204.703 159.923 204.347 160.413L202.92 162.373ZM200.591 159.581L201.198 158.747C201.357 158.528 201.43 158.296 201.416 158.05C201.405 157.8 201.288 157.593 201.064 157.43C200.839 157.267 200.606 157.219 200.365 157.287C200.127 157.349 199.927 157.49 199.768 157.709L199.161 158.542L200.591 159.581ZM202.828 161.204L203.663 160.056C203.864 159.781 203.954 159.5 203.933 159.214C203.908 158.925 203.774 158.692 203.531 158.515C203.283 158.335 203.02 158.28 202.741 158.349C202.459 158.415 202.217 158.584 202.016 158.86L201.181 160.008L202.828 161.204ZM207.387 156.412C207.044 156.883 206.581 157.175 205.999 157.288C205.416 157.393 204.851 157.246 204.305 156.849C203.767 156.459 203.449 155.978 203.35 155.408C203.247 154.833 203.361 154.317 203.695 153.86C204.021 153.412 204.463 153.137 205.022 153.037C205.577 152.932 206.185 153.121 206.849 153.603L206.947 153.674L205.041 156.293C205.377 156.48 205.708 156.53 206.033 156.446C206.358 156.353 206.619 156.171 206.816 155.901C206.925 155.751 207.007 155.584 207.065 155.397C207.121 155.202 207.14 154.995 207.121 154.775L207.872 154.656C207.915 154.951 207.892 155.252 207.804 155.559C207.719 155.861 207.581 156.145 207.387 156.412ZM204.528 155.909L205.893 154.033C205.646 153.882 205.368 153.822 205.059 153.855C204.753 153.882 204.507 154.025 204.319 154.281C204.123 154.552 204.052 154.84 204.109 155.145C204.169 155.446 204.309 155.7 204.528 155.909ZM209.042 154.109C208.991 154.179 208.931 154.242 208.861 154.299C208.795 154.35 208.754 154.381 208.739 154.392L208.143 153.96C208.155 153.954 208.177 153.938 208.21 153.912C208.243 153.886 208.275 153.852 208.305 153.81C208.421 153.651 208.416 153.476 208.291 153.285C208.169 153.09 207.943 152.851 207.613 152.568C207.388 152.377 207.169 152.193 206.954 152.015C206.739 151.83 206.551 151.673 206.389 151.541C206.223 151.406 206.09 151.299 205.991 151.22C205.89 151.133 205.839 151.089 205.839 151.089L207.541 148.75L211.005 151.264L210.5 151.958L207.605 149.856L206.851 150.892C207.015 151.019 207.212 151.175 207.44 151.362C207.669 151.549 207.893 151.737 208.113 151.926C208.613 152.346 208.952 152.735 209.129 153.091C209.305 153.448 209.276 153.787 209.042 154.109ZM212.95 148.768C212.603 149.244 212.137 149.527 211.551 149.615C210.965 149.703 210.409 149.556 209.881 149.173C209.353 148.789 209.04 148.306 208.943 147.722C208.847 147.138 208.972 146.609 209.318 146.132C209.665 145.656 210.131 145.374 210.717 145.286C211.303 145.197 211.859 145.345 212.387 145.728C212.915 146.111 213.228 146.595 213.325 147.178C213.421 147.762 213.296 148.292 212.95 148.768ZM212.34 148.326C212.561 148.022 212.629 147.693 212.543 147.339C212.453 146.981 212.233 146.676 211.883 146.421C211.537 146.17 211.18 146.057 210.812 146.083C210.443 146.107 210.149 146.272 209.928 146.575C209.707 146.878 209.642 147.209 209.731 147.567C209.821 147.924 210.039 148.228 210.385 148.479C210.735 148.734 211.095 148.848 211.463 148.824C211.827 148.795 212.119 148.629 212.34 148.326ZM215.955 144.638C215.582 145.151 215.089 145.436 214.477 145.491C213.861 145.543 213.226 145.332 212.571 144.857L212.459 144.775C212.076 144.497 211.734 144.202 211.432 143.89C211.131 143.578 210.907 143.248 210.76 142.899C210.617 142.546 210.572 142.167 210.623 141.762C210.675 141.358 210.861 140.921 211.179 140.454C211.335 140.231 211.461 140.023 211.558 139.83C211.651 139.634 211.698 139.486 211.699 139.387L212.316 139.835C212.315 139.934 212.268 140.082 212.175 140.278C212.077 140.471 211.951 140.679 211.796 140.902C211.387 141.503 211.245 142.017 211.371 142.444C211.495 142.862 211.773 143.27 212.203 143.669L212.214 143.655C212.135 143.42 212.119 143.152 212.167 142.851C212.21 142.546 212.328 142.261 212.522 141.995C212.841 141.556 213.277 141.291 213.829 141.2C214.377 141.106 214.912 141.248 215.435 141.628C215.963 142.011 216.269 142.49 216.351 143.063C216.437 143.632 216.305 144.157 215.955 144.638ZM215.362 144.218C215.576 143.923 215.647 143.6 215.574 143.248C215.502 142.896 215.293 142.594 214.947 142.343C214.606 142.096 214.257 141.992 213.899 142.032C213.541 142.072 213.255 142.239 213.041 142.533C212.827 142.827 212.757 143.15 212.829 143.503C212.901 143.854 213.108 144.154 213.449 144.402C213.795 144.653 214.147 144.758 214.504 144.718C214.862 144.678 215.148 144.511 215.362 144.218ZM218.061 140.538C218.23 140.305 218.299 140.044 218.265 139.757C218.231 139.46 218.073 139.211 217.793 139.007L217.618 138.88C217.529 138.972 217.439 139.071 217.348 139.176C217.257 139.281 217.183 139.374 217.125 139.453C216.908 139.752 216.795 140.02 216.787 140.257C216.775 140.49 216.857 140.671 217.035 140.8C217.175 140.901 217.342 140.937 217.535 140.907C217.729 140.876 217.904 140.753 218.061 140.538ZM218.533 141.096C218.279 141.446 217.961 141.658 217.579 141.73C217.193 141.799 216.843 141.72 216.53 141.493C216.245 141.286 216.071 140.981 216.007 140.578C215.947 140.17 216.113 139.695 216.507 139.154C216.579 139.056 216.667 138.949 216.773 138.833C216.877 138.709 216.981 138.596 217.085 138.493L216.903 138.361C216.688 138.205 216.473 138.156 216.259 138.215C216.045 138.273 215.86 138.41 215.703 138.624C215.575 138.802 215.483 138.996 215.43 139.207C215.376 139.418 215.347 139.6 215.343 139.753L214.592 139.872C214.574 139.602 214.608 139.32 214.694 139.026C214.778 138.723 214.917 138.439 215.111 138.173C215.427 137.739 215.793 137.48 216.211 137.398C216.631 137.311 217.042 137.413 217.444 137.705L219.687 139.333L219.198 140.006L218.82 139.731L218.809 139.745C218.875 139.949 218.885 140.171 218.84 140.409C218.795 140.648 218.693 140.877 218.533 141.096ZM220.398 138.358L216.935 135.844L217.434 135.157L219.803 136.878L219.813 136.864L218.616 133.533L219.069 132.91L222.533 135.424L222.033 136.11L219.671 134.395L219.661 134.409L220.851 137.735L220.398 138.358ZM217.566 134.033C217.349 134.332 217.103 134.532 216.829 134.633C216.555 134.727 216.343 134.773 216.194 134.771L216.093 134.099C216.208 134.089 216.356 134.047 216.539 133.973C216.717 133.895 216.865 133.774 216.984 133.611C217.103 133.448 217.172 133.27 217.191 133.077C217.205 132.88 217.2 132.727 217.174 132.615L217.845 132.503C217.892 132.644 217.912 132.862 217.905 133.156C217.897 133.442 217.783 133.735 217.566 134.033ZM223.269 134.412L219.806 131.898L220.305 131.212L221.714 132.235L222.122 131.675L221.395 129.714L221.956 128.944L222.77 131.226L225.577 131.24L224.961 132.088L222.725 132.038L222.282 132.647L223.768 133.727L223.269 134.412Z" fill="black"/>
    <path d="M103.663 201.524L101.253 201.533L101.251 201.112L102.192 200.172C102.543 199.819 102.78 199.553 102.903 199.375C103.031 199.197 103.094 199.023 103.093 198.853C103.093 198.664 103.027 198.514 102.895 198.401C102.763 198.287 102.599 198.231 102.403 198.232C102.208 198.233 102.028 198.278 101.865 198.367C101.702 198.453 101.565 198.546 101.455 198.646L101.107 198.301C101.231 198.169 101.409 198.042 101.639 197.921C101.87 197.799 102.124 197.738 102.401 197.737C102.803 197.735 103.111 197.846 103.325 198.068C103.539 198.288 103.647 198.536 103.648 198.813C103.649 199.069 103.572 199.309 103.416 199.533C103.261 199.754 103.039 200.005 102.752 200.287L101.998 201.03V201.041L103.838 201.034L103.663 201.524ZM104.275 201.522L104.273 201.032L105.062 201.029L105.051 198.281L104.321 198.283L104.319 197.793L105.583 197.789L105.595 201.027L106.443 201.024L106.243 201.515L104.275 201.522ZM108.128 201.571C107.684 201.573 107.337 201.4 107.086 201.053C106.836 200.703 106.71 200.234 106.707 199.648C106.705 199.066 106.828 198.599 107.075 198.246C107.323 197.894 107.669 197.717 108.114 197.715C108.558 197.714 108.905 197.888 109.155 198.239C109.406 198.589 109.532 199.056 109.534 199.638C109.537 200.224 109.414 200.693 109.166 201.045C108.919 201.395 108.573 201.57 108.128 201.571ZM108.126 201.081C108.407 201.081 108.618 200.948 108.759 200.685C108.904 200.421 108.976 200.073 108.974 199.64C108.973 199.207 108.899 198.859 108.751 198.597C108.609 198.335 108.397 198.204 108.115 198.205C107.835 198.206 107.622 198.338 107.477 198.602C107.336 198.865 107.266 199.214 107.267 199.646C107.269 200.08 107.341 200.427 107.485 200.69C107.631 200.952 107.845 201.083 108.126 201.081ZM111.343 201.559C111.077 201.561 110.829 201.517 110.601 201.429C110.377 201.338 110.188 201.216 110.035 201.064L110.396 200.7C110.524 200.817 110.665 200.909 110.818 200.975C110.971 201.039 111.142 201.07 111.331 201.069C111.555 201.069 111.746 201.004 111.906 200.875C112.069 200.744 112.15 200.569 112.149 200.353C112.148 200.122 112.057 199.947 111.875 199.826C111.693 199.706 111.475 199.646 111.219 199.648C111.169 199.648 111.119 199.65 111.069 199.654C111.019 199.657 110.971 199.663 110.925 199.67L110.924 199.335L111.997 198.255L110.248 198.261L110.246 197.771L112.625 197.762L112.627 198.194L111.627 199.199V199.21C111.937 199.244 112.193 199.365 112.397 199.574C112.604 199.779 112.708 200.037 112.709 200.345C112.711 200.682 112.58 200.969 112.318 201.204C112.055 201.439 111.731 201.558 111.343 201.559ZM114.789 201.547C114.345 201.548 113.998 201.375 113.747 201.029C113.497 200.678 113.371 200.21 113.369 199.624C113.367 199.041 113.489 198.574 113.737 198.222C113.985 197.869 114.331 197.692 114.775 197.69C115.219 197.688 115.567 197.863 115.817 198.214C116.067 198.564 116.193 199.031 116.195 199.613C116.198 200.199 116.075 200.668 115.827 201.021C115.58 201.369 115.234 201.545 114.789 201.547ZM114.788 201.057C115.069 201.055 115.28 200.923 115.421 200.66C115.566 200.397 115.637 200.049 115.635 199.615C115.634 199.182 115.56 198.834 115.413 198.572C115.27 198.309 115.058 198.179 114.777 198.18C114.496 198.181 114.283 198.313 114.139 198.576C113.997 198.84 113.927 199.188 113.929 199.622C113.931 200.055 114.003 200.403 114.146 200.664C114.293 200.927 114.507 201.057 114.788 201.057Z" fill="black"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M200.985 166.219C200.359 164.579 199.536 162.423 198.477 161.664C197.208 160.757 195.441 161.02 194.53 162.252C193.62 163.484 193.911 165.218 195.18 166.126C196.406 167.003 199.393 167.072 201.151 167.112L201.333 167.117C201.225 166.848 201.108 166.544 200.985 166.219ZM196.737 165.536C197.704 165.536 198.489 164.764 198.489 163.813C198.489 162.86 197.704 162.089 196.737 162.089C195.769 162.089 194.984 162.86 194.984 163.813C194.984 164.764 195.769 165.536 196.737 165.536Z" fill="black"/>
    <path d="M198.287 163.623C198.236 163.223 198.026 162.859 197.703 162.612C197.38 162.365 196.971 162.253 196.565 162.303C196.564 162.303 196.562 162.302 196.561 162.302C196.559 162.303 196.558 162.304 196.556 162.304C196.151 162.354 195.782 162.561 195.531 162.879C195.28 163.197 195.167 163.6 195.217 164C195.217 164.002 195.216 164.003 195.216 164.005C195.217 164.006 195.218 164.007 195.218 164.009C195.269 164.409 195.479 164.772 195.802 165.02C196.124 165.267 196.534 165.378 196.939 165.329C196.941 165.329 196.942 165.329 196.944 165.329C196.946 165.329 196.947 165.328 196.949 165.328C197.354 165.277 197.723 165.07 197.974 164.752C198.225 164.435 198.338 164.032 198.288 163.632C198.288 163.63 198.289 163.629 198.288 163.627C198.288 163.625 198.287 163.624 198.287 163.623ZM196.149 164.85L196.636 164.233L196.734 165.008C196.529 165.005 196.327 164.95 196.149 164.85ZM195.585 164.126L196.37 164.03L195.884 164.646C195.741 164.501 195.638 164.322 195.585 164.126ZM197.356 162.782L196.869 163.398L196.771 162.624C196.976 162.627 197.178 162.681 197.356 162.782ZM196.535 163.439L195.91 162.96C196.057 162.819 196.239 162.718 196.437 162.665L196.535 163.439ZM196.329 163.701L195.543 163.797C195.546 163.595 195.601 163.397 195.703 163.222L196.329 163.701ZM196.97 164.192L197.595 164.672C197.447 164.813 197.266 164.914 197.068 164.966L196.97 164.192ZM197.176 163.931L197.962 163.834C197.959 164.037 197.904 164.235 197.801 164.41L197.176 163.931ZM197.135 163.602L197.621 162.986C197.764 163.131 197.867 163.31 197.92 163.505L197.135 163.602Z" fill="black"/>
</g>

<!-- Подножка велосипеда -->
<g id="footboard" class="bike-part">
    <path d="M140.675 206.113C138.536 206.402 138.001 203.584 138.001 202.139H142.547C142.814 203.343 142.814 205.824 140.675 206.113Z" fill="black" stroke="black"/>
    <path d="M137.667 207.798C142.467 207.798 143.334 203.804 141.001 202.805C141.001 202.805 138.668 203.138 140.001 204.469C141.333 205.801 110.401 205.135 109.334 205.135H106.001L106 208.464C106 208.464 107.333 208.131 111.667 207.798C116 207.466 132.867 207.798 137.667 207.798Z" fill="black" stroke="black"/>
    <path d="M140.668 204.802C141.036 204.802 141.335 204.504 141.335 204.137C141.335 203.769 141.036 203.471 140.668 203.471C140.3 203.471 140.001 203.769 140.001 204.137C140.001 204.504 140.3 204.802 140.668 204.802Z" fill="#A9A9A9"/>
</g>

<!-- Защита цепи -->
<g id="chain-guard" class="bike-part">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M78.334 190.488C90.8893 186.826 124.353 179.236 155.553 184.829C186.753 190.422 180.22 209.464 173.219 215.123C166.331 219.672 151.285 224.111 144.885 201.474C143.219 197.701 127.001 191.819 80.334 194.482C77.2227 194.482 72.3347 192.485 78.334 190.488ZM162.219 213.458C168.111 213.458 172.886 208.689 172.886 202.806C172.886 196.922 168.111 192.153 162.219 192.153C156.328 192.153 151.553 196.922 151.553 202.806C151.553 208.689 156.328 213.458 162.219 213.458Z" fill="black" stroke="black"/>
    <path d="M78.3333 193.484C78.8856 193.484 79.3333 193.037 79.3333 192.485C79.3333 191.933 78.8856 191.486 78.3333 191.486C77.7811 191.486 77.3333 191.933 77.3333 192.485C77.3333 193.037 77.7811 193.484 78.3333 193.484Z" fill="#A9A9A9"/>
</g>

<!-- Педали -->
<g id="pedals" class="bike-part">
    <path d="M166.667 175.174L167.667 172.511H162.667V166.186H181.333L180.667 168.115L177 172.443L173.667 172.511L172.667 175.174H166.667Z" fill="black" fill-opacity="0.9" stroke="black"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M173 202.805C173 208.688 168.225 213.458 162.333 213.458C156.442 213.458 151.667 208.688 151.667 202.805C151.667 196.921 156.442 192.152 162.333 192.152C168.225 192.152 173 196.921 173 202.805ZM162.333 208.131C165.279 208.131 167.667 205.746 167.667 202.805C167.667 199.863 165.279 197.479 162.333 197.479C159.388 197.479 157 199.863 157 202.805C157 205.746 159.388 208.131 162.333 208.131ZM168.333 205.135C169.667 203.005 168.889 200.475 168.333 199.476C168 198.144 169.333 197.479 170.667 198.477C171.421 199.042 172.361 204.441 170.333 206.467C169 207.798 168 205.801 168.333 205.135ZM162.442 209.856C164.69 210.117 166.379 208.467 166.943 207.609C167.863 206.804 168.947 207.647 168.706 209.149C168.57 210 164.666 212.923 162.213 212.044C160.601 211.466 161.774 209.844 162.442 209.856ZM158.489 197.49C156.153 198.423 155.284 200.923 155.142 202.057C154.623 203.328 153.154 203.079 152.669 201.486C152.394 200.585 154.829 195.674 157.663 195.235C159.526 194.947 159.151 197.149 158.489 197.49ZM155.91 204.828C156.374 207.298 158.661 208.633 159.747 208.992C160.895 209.747 160.366 211.139 158.707 211.305C157.769 211.4 153.417 208.062 153.536 205.201C153.614 203.319 155.704 204.113 155.91 204.828ZM166.637 197.598C164.869 195.811 162.224 195.984 161.123 196.295C159.749 196.312 159.407 194.863 160.687 193.797C161.412 193.194 166.889 193.524 168.395 195.961C169.386 197.564 167.209 198.076 166.637 197.598Z" fill="black" fill-opacity="0.9"/>
    <path d="M161.667 213.458C159.442 213.458 157.376 212.777 155.667 211.614L147.333 231.772H140V237.431H158.667V231.772H153.333L161.667 213.458Z" fill="black" fill-opacity="0.9"/>
    <path d="M167.667 202.805C167.667 205.746 165.279 208.131 162.333 208.131C159.388 208.131 157 205.746 157 202.805C157 199.863 159.388 197.479 162.333 197.479C165.279 197.479 167.667 199.863 167.667 202.805Z" fill="black"/>
    <path d="M163.333 203.138C163.333 203.689 162.885 204.137 162.333 204.137C161.781 204.137 161.333 203.689 161.333 203.138C161.333 202.586 161.781 202.139 162.333 202.139C162.885 202.139 163.333 202.586 163.333 203.138Z" fill="#C8C8C8"/>
</g>

<!-- Седло велосипеда -->
<g id="saddle" class="bike-part">
    <path d="M119.906 95.9422C123.239 92.3908 131.906 85.4891 139.906 86.2881C141.239 86.5105 143.639 86.2894 142.573 83.6262C141.506 80.963 140.667 78.9656 139.239 78.9656L129.239 79.6314C126.239 80.186 119.573 81.2959 116.906 81.2959C113.573 81.2959 106.573 80.2972 99.2393 77.634C96.7953 77.855 92.2393 79.895 93.5727 86.2881C93.906 86.8434 94.706 88.0205 95.2393 88.2868V93.8869C95.2393 93.9461 95.2393 96.6094 98.5727 96.6094C101.906 96.6094 103.239 95.9436 103.573 94.612H109.906C109.795 96.4982 110.973 100.904 114.906 98.9397C115.573 98.6068 116.173 97.8051 115.906 95.9422H119.906Z" fill="black"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M127.906 118.248L122.906 121.244L114.906 98.9397C115.973 98.407 116.017 96.7199 115.906 95.9436H119.906L127.239 113.92H128.573C129.906 112.256 131.451 111.581 133.239 112.922C134.573 113.92 133.239 116.805 132.239 118.248C129.039 125.705 137.129 128.013 141.573 128.235C141.906 128.346 142.573 128.701 142.573 129.234C142.573 129.766 142.129 130.121 141.906 130.232C128.573 131.031 127.017 122.576 127.906 118.248ZM131.239 116.251C131.976 116.251 132.573 115.654 132.573 114.919C132.573 114.183 131.976 113.587 131.239 113.587C130.503 113.587 129.906 114.183 129.906 114.919C129.906 115.654 130.503 116.251 131.239 116.251Z" fill="black" stroke="black"/>
    <path d="M131.333 116.251C132.254 116.251 133 115.505 133 114.586C133 113.667 132.254 112.922 131.333 112.922C130.413 112.922 129.667 113.667 129.667 114.586C129.667 115.505 130.413 116.251 131.333 116.251Z" fill="#A9A9A9"/>
    <path d="M113 97.6081C113.92 97.6081 114.667 96.8628 114.667 95.9436C114.667 95.0243 113.92 94.2791 113 94.2791C112.08 94.2791 111.333 95.0243 111.333 95.9436C111.333 96.8628 112.08 97.6081 113 97.6081Z" fill="#A9A9A9"/>
</g>

<!-- Передний фонарь велосипеда -->
<g id="front-light" class="bike-part">
    <path d="M276 110.258C277.667 111.923 276.667 113.587 276.667 113.587" stroke="#BCBCBC"/>
    <path d="M271.333 114.586C272.667 124.973 264.555 129.123 260.333 129.9L259 126.571C266.733 126.038 268.111 118.691 267.667 115.252L265.333 115.585L264.667 111.923L276 109.925L276.667 113.587L271.333 114.586Z" fill="black" stroke="black"/>
</g>

<!-- Задний светоотражатель -->
<g id="retroreflector" class="bike-part">
    <path d="M12 151.286C9.33334 150.177 3.66668 150.621 2.33334 161.273C5.33334 159.528 10.4 155.283 12 151.286Z" fill="#FF0000"/>
</g>

<!-- Переключалка передач -->
<g id="gearshift" class="bike-part">
    <path d="M72.702 201.057C72.3707 198.053 65.0376 194.444 62.369 199.06C59.7003 203.676 72.3713 204.378 72.702 201.057Z" fill="#949494" stroke="black" stroke-width="0.4"/>
    <path d="M71.63 198.523C70.2967 196.303 66.3635 193.13 61.2969 198.19" stroke="black" stroke-width="4.4" stroke-linecap="round"/>
    <path d="M63.6667 197.522C64.2189 197.522 64.6667 197.075 64.6667 196.524C64.6667 195.972 64.2189 195.525 63.6667 195.525C63.1144 195.525 62.6667 195.972 62.6667 196.524C62.6667 197.075 63.1144 197.522 63.6667 197.522Z" fill="#A9A9A9"/>
    <path d="M69.6667 197.522C70.2189 197.522 70.6667 197.075 70.6667 196.524C70.6667 195.972 70.2189 195.525 69.6667 195.525C69.1144 195.525 68.6667 195.972 68.6667 196.524C68.6667 197.075 69.1144 197.522 69.6667 197.522Z" fill="#A9A9A9"/>
    <path d="M62.2888 197.522C62.2888 197.522 59.9994 200.519 59.3327 201.517C58.6661 202.516 59.3327 205.801 59.3327 205.801C60.7772 207.909 62.6667 209.796 67.2887 206.467C67.2887 206.467 66.6221 202.849 67.9553 201.517C69.2887 200.186 71.2887 198.854 71.2887 198.854" stroke="black" stroke-width="1.4" stroke-linecap="round"/>
</g>

<!-- Корзина велосипеда -->
<g id="basket" class="bike-part">
    <path d="M251.667 113.92L236 75.6366C251.555 71.42 285.067 62.1874 294.667 58.9915C304.267 55.7957 312 56.9941 314.667 57.9928L307 98.9397C307 102.934 303.889 104.821 302.333 105.265L251.667 113.92Z" fill="black" stroke="black"/>
</g>

<!-- Руль велосипеда -->
<g id="handlebars" class="bike-part">
    <path d="M241.366 86.9326L232.366 89.9287L224.699 71.9507H218.699C214.699 69.2875 216.588 66.4026 218.033 65.2929C221.233 64.7603 221.81 61.52 221.699 59.9665L236.366 49.3136L239.699 54.3072C241.255 47.4272 245.333 37.6855 242 31.0275C240.772 28.575 233.033 22.7925 229.033 20.3512C226.366 20.3512 223.366 19.3525 221.366 17.0222C219.766 15.1579 220.255 11.3629 220.699 9.69835L220.033 7.03514C217.699 4.70484 217.699 0.711011 221.699 0.0452087C224.899 -0.487434 226.143 3.81809 226.366 6.03744L229.366 10.0323C230.433 10.5649 231.81 13.5832 232.366 15.0258L242.699 23.3483C247 26.3669 247.333 26.3669 249.699 32.3367C252.318 38.9443 246.588 53.4204 244.033 59.6346L247.033 64.2952L244.699 66.6256C246.299 67.9572 246.255 72.0632 246.033 73.9494L238.366 77.2784L241.366 86.9326Z" fill="black"/>
</g>

<!-- Блок троса -->
<g id="cable-block" class="bike-part">
<path d="M230.001 109.593L226.867 106.929L232.447 99.2726L235.667 101.936L230.001 109.593Z" fill="black"/>
</g>

</g>
<defs>
<clipPath id="clip0_586_2">
<rect width="355" height="263" fill="white"/>
</clipPath>
</defs>
</svg>


            `;
            
            // После загрузки SVG добавляем обработчики для деталей
            setTimeout(() => {
                setupBikePartsInteractivity();
            }, 100);
        }

        // Настройка интерактивности деталей велосипеда
        function setupBikePartsInteractivity() {
            const parts = document.querySelectorAll('.bike-part');
            parts.forEach(part => {
                part.addEventListener('click', handlePartClick);
            });
        }

        // Обработчик клика на деталь
        function handlePartClick(event) {

            const partId = event.currentTarget.id;
            currentPart = partId;
            
            // Подсвечиваем выбранную деталь
            document.querySelectorAll('.bike-part').forEach(p => p.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            // Показываем выпадающий список поломок
            showDamageDropdown(partId, event.currentTarget);
        }

        // Показать выпадающий список поломок
        function showDamageDropdown(partId, partElement) {
            const dropdown = document.getElementById('damage-dropdown');
            const rect = partElement.getBoundingClientRect();
            const viewport = {
                width: window.innerWidth,
                height: window.innerHeight
            };
            
            // Рассчитываем позицию
            let left = rect.left;
            let top = rect.bottom + 5;
            
            // Настройки dropdown
            const dropdownWidth = Math.min(280, viewport.width - 40);
            const dropdownMaxHeight = 200;
            
            // Проверяем правый край
            if (left + dropdownWidth > viewport.width - 10) {
                left = viewport.width - dropdownWidth - 10;
            }
            
            // Проверяем левый край
            if (left < 10) {
                left = 10;
            }
            
            // Проверяем нижний край - если не помещается вниз, показываем сверху
            const estimatedHeight = Math.min(dropdownMaxHeight, (damageData[partId]?.length || 0) * 40 + 20);
            if (top + estimatedHeight > viewport.height - 10) {
                top = rect.top - estimatedHeight - 5;
            }
            
            dropdown.style.left = left + 'px';
            dropdown.style.top = top + 'px';
            dropdown.style.width = dropdownWidth + 'px';
            dropdown.style.maxHeight = dropdownMaxHeight + 'px';
            dropdown.style.display = 'block';
            dropdown.style.zIndex = '1000';
            
            // Заполняем список поломок
            const damages = damageData[partId] || [];
            dropdown.innerHTML = '';
            
            if (damages.length === 0) {
                dropdown.innerHTML = '<div class="damage-option">Нет данных о поломках</div>';
                return;
            }
            
            damages.forEach(damage => {
                const option = document.createElement('div');
                option.className = 'damage-option';
                option.textContent = damage;
                option.addEventListener('click', () => selectDamage(damage, partId));
                dropdown.appendChild(option);
            });
            
            // Закрытие при клике вне списка
            setTimeout(() => {
                document.addEventListener('click', closeDropdownOnClickOutside);
            }, 10);
        }

        // Закрыть выпадающий список при клике вне
        function closeDropdownOnClickOutside(event) {
            const dropdown = document.getElementById('damage-dropdown');
            if (!dropdown.contains(event.target) && !event.target.closest('.bike-part')) {
                dropdown.style.display = 'none';
                document.querySelectorAll('.bike-part').forEach(p => p.classList.remove('active'));
                document.removeEventListener('click', closeDropdownOnClickOutside);
            }
        }

        // Выбор поломки
        function selectDamage(damage, partId) {
            const damageId = Date.now(); // Уникальный ID для поломки
            
            selectedDamages.push({
                id: damageId,
                part: partId,
                description: damage
            });
            
            updateDamagesList();
            updateSubmitButton();
            
            // Закрываем выпадающий список
            document.getElementById('damage-dropdown').style.display = 'none';
            document.querySelectorAll('.bike-part').forEach(p => p.classList.remove('active'));
            document.removeEventListener('click', closeDropdownOnClickOutside);
            
            showNotification('Поломка добавлена');
        }

        // Обновление списка выбранных поломок
        function updateDamagesList() {
            const list = document.getElementById('damages-list');
            
            if (selectedDamages.length === 0) {
                list.innerHTML = '<div class="empty-damages">Поломки не выбраны</div>';
                return;
            }
            
            list.innerHTML = '';
            selectedDamages.forEach(damage => {
                const item = document.createElement('div');
                item.className = 'damage-item';
                item.innerHTML = `
                    <div class="damage-info">
                        <div class="damage-part">${getPartName(damage.part)}</div>
                        <div class="damage-description">${damage.description}</div>
                    </div>
                    <button class="remove-damage" data-id="${damage.id}">×</button>
                `;
                list.appendChild(item);
            });
            
            // Добавляем обработчики для кнопок удаления
            document.querySelectorAll('.remove-damage').forEach(btn => {
                btn.addEventListener('click', removeDamage);
            });
        }

        // Удаление поломки
        function removeDamage(event) {
            const damageId = parseInt(event.target.getAttribute('data-id'));
            selectedDamages = selectedDamages.filter(damage => damage.id !== damageId);
            updateDamagesList();
            updateSubmitButton();
            showNotification('Поломка удалена');
        }

        // Получение читаемого названия детали
        function getPartName(partId) {
            const partNames = {
                'rear-wheel': 'Заднее колесо',
                'front-wheel': 'Переднее колесо',
                'rear-wheel': 'Мотор-колесо',
                'motor': 'Мотор-колесо',
                'rear-ad-sign': 'Задний рекламный щит',
                'front-ad-sign': 'Передний рекламный щит',
                'lock': 'Замок-подкова',
                'frame': 'Рама',
                'chain': 'Цепь',
                'battery': 'Батарея',
                'footboard': 'Подножка',
                'saddle': 'Седло',
                'handlebars': 'Руль',
                'pedals': 'Педали',
                'chain-guard': 'Защита цепи',
                'light-marker': 'Световой маркер',
                'retroreflector': 'Задний светоотражатель',
                'gearshift': 'Переключалка передач',
                'basket': 'Корзина',
                'cable-block': 'Блок троса',
                'front-light': 'Передний фонарь'
            };
            
            return partNames[partId] || partId;
        }

        // Обновление состояния кнопки отправки
        function updateSubmitButton() {
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.disabled = !currentBikeNumber || selectedDamages.length === 0;
        }

        // Валидация номера велосипеда
        function validateBikeNumber(number) {
            const num = parseInt(number);
            return !isNaN(num) && num >= 20000 && num <= 29030;
        }

        // Показать уведомление
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            
            // Удаляем существующее уведомление
            const existingNotification = document.querySelector('.notification.show');
            if (existingNotification) {
                existingNotification.classList.remove('show');
            }
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Отправка данных админу
        async function sendReportToAdmin() {
            const bikeNumber = document.getElementById('bike-number').value.trim();
            const numberError = document.getElementById('number-error');
            
            // ВАЛИДАЦИЯ НОМЕРА ПЕРЕД ОТПРАВКОЙ
            if (!validateBikeNumber(bikeNumber)) {
                numberError.style.display = 'block';
                document.getElementById('bike-number').style.borderColor = '#ff4444';
                showNotification('Введите корректный номер велосипеда (20000-29030)');
                return;
            }
            
            // Проверяем, что есть поломки
            if (selectedDamages.length === 0) {
                showNotification('Выберите хотя бы одну поломку');
                return;
            }
            
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Отправка...';
            
            try {
                const report = {
                    bikeNumber: currentBikeNumber,
                    damages: selectedDamages,
                    timestamp: new Date().toISOString(),
                    user: telegramWebApp ? telegramWebApp.initDataUnsafe.user : null
                };
                
                // Формируем текст сообщения для админа
                let messageText = `<b>Новая заявка на ремонт</b>\n`;
                messageText += `<b>Велосипед:</b> №${report.bikeNumber}\n`;
                messageText += `<b>Время:</b> ${new Date().toLocaleString()}\n\n`;
                messageText += `<b>Список поломок:</b>\n`;
                
                report.damages.forEach((damage, index) => {
                    messageText += `${index + 1}. <i>${getPartName(damage.part)}</i>: ${damage.description}\n`;
                });
                
                // Отправка через Telegram Bot API в тему группы
                const botToken = '8201906085:AAF7GhKDhy4NpjOD9QEO05ddR8hQM8X2lEw'; // Замени на реальный токен бота
                const chatId = '-1002981629310'; // Замени на ID группы
                const messageThreadId = 11; // ID темы в группе
                
                const response = await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: chatId,
                        message_thread_id: messageThreadId, // Отправка в конкретную тему
                        text: messageText,
                        parse_mode: 'HTML'
                    })
                });
                
                const result = await response.json();
                
                if (response.ok && result.ok) {
                    showConfirmationModal();
                } else {
                    throw new Error(result.description || 'Ошибка отправки');
                }
                
            } catch (error) {
                console.error('Ошибка отправки:', error);
                showNotification('Ошибка отправки заявки: ' + error.message);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Отправить заявку';
            }
        }

        // Показать модальное окно подтверждения
        function showConfirmationModal() {
            const modal = document.getElementById('confirmation-modal');
            const bikeNumberConfirm = document.getElementById('bike-number-confirm');
            
            bikeNumberConfirm.textContent = currentBikeNumber;
            modal.classList.add('active');
        }

        // Скрыть модальное окно
        function hideModal(modal) {
            modal.classList.add('fade-out');
            setTimeout(() => {
                modal.classList.remove('active');
                modal.classList.remove('fade-out');
                
                // Сбрасываем форму после успешной отправки
                if (modal.id === 'confirmation-modal') {
                    resetForm();
                }
            }, 300);
        }

        // Сброс формы
        function resetForm() {
            currentBikeNumber = '';
            selectedDamages = [];
            document.getElementById('bike-number').value = '';
            updateDamagesList();
            updateSubmitButton();
            document.querySelectorAll('.bike-part').forEach(p => p.classList.remove('active'));
        }

        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            initTelegramWebApp();
            loadBikeSVG();
            loadDamageData();
            resizeBikeSVG();

            // Обработчики для поля ввода номера
            const bikeInput = document.getElementById('bike-number');
            const validateBtn = document.getElementById('validate-btn');
            const numberError = document.getElementById('number-error');
            const submitBtn = document.getElementById('submit-btn');
            
            validateBtn.addEventListener('click', function() {
                const number = bikeInput.value.trim();
                
                if (validateBikeNumber(number)) {
                    currentBikeNumber = number;
                    numberError.style.display = 'none';
                    bikeInput.style.borderColor = 'var(--border-color)';
                    showNotification(`Номер ${number} подтвержден`);
                    updateSubmitButton();
                } else {
                    numberError.style.display = 'block';
                    bikeInput.style.borderColor = '#ff4444';
                }
            });
            
            bikeInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    validateBtn.click();
                }
            });
            
            bikeInput.addEventListener('input', function() {
                numberError.style.display = 'none';
                bikeInput.style.borderColor = 'var(--border-color)';
                currentBikeNumber = '';
                updateSubmitButton();
            });
            
            // Обработчик отправки формы
            submitBtn.addEventListener('click', sendReportToAdmin);
            
            // Обработчики модального окна
            const modal = document.getElementById('confirmation-modal');
            const modalClose = document.getElementById('modal-close');
            const modalOk = document.getElementById('modal-ok-btn');
            
            modalClose.addEventListener('click', () => hideModal(modal));
            modalOk.addEventListener('click', () => hideModal(modal));
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) hideModal(modal);
            });
        });
    </script>
</body>
</html>
