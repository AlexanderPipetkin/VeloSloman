<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Фиксация поломок велосипедов</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary-bg: #000;
            --primary-text: #fff;
            --border-color: #fff;
            --border-radius: 12px;
            --border-radius-small: 8px;
            --border-width: 1px;
            --transition: all 0.3s ease;
        }

        @font-face {
            font-family: 'Moscow Sans';
            src: url('fonts/MOSCOWSANSREGULAR.woff2') format('woff2'),
                url('fonts/MOSCOWSANSREGULAR.TTF') format('truetype');
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Moscow Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.3);
        }

        body {
            background-color: var(--primary-bg);
            color: var(--primary-text);
            min-height: 100vh;
            padding: 20px 12px 80px;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 15px;
            overflow-x: hidden;
            box-sizing: border-box;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 28px;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .page-description {
            font-size: 16px;
            color: #ccc;
            line-height: 1.4;
        }

        .input-section {
            margin-bottom: 30px;
        }

        .input-label {
            display: block;
            font-size: 16px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .input-wrapper {
            display: flex;
            gap: 10px;
            align-items: stretch;
            flex-wrap: nowrap;
        }

        .bike-input {
            flex: 1;
            min-width: 0;
            height: 50px;
            border: var(--border-width) solid var(--border-color);
            border-radius: var(--border-radius);
            background: transparent;
            color: var(--primary-text);
            padding: 0 15px;
            font-size: 16px;
            transition: var(--transition);
            box-sizing: border-box;
            }

        .bike-input:focus {
            outline: none;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .validate-btn {
            height: 50px;
            padding: 0 20px;
            border: var(--border-width) solid var(--border-color);
            border-radius: var(--border-radius);
            background: transparent;
            color: var(--primary-text);
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
            flex-shrink: 0;
            box-sizing: border-box;
        }

        .validate-btn:active {
            transform: scale(0.98);
        }

        .bike-section {
            margin-bottom: 30px;
            position: relative;
        }
        
        .bike-container {
            width: 100%;
            border: var(--border-width) solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 15px;
            background: #3A3A3A;
            overflow-x: auto;
            overflow-y: hidden;
            position: relative;
            box-sizing: border-box;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            min-height: 300px;
            -webkit-overflow-scrolling: touch;
        }
        
        .bike-svg {
            width: auto;
            height: 300px;
            min-width: 500px;
            display: block;
            margin: 0 auto;
        }

        .bike-container::-webkit-scrollbar {
            height: 8px;
        }

        .bike-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .bike-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }

        .bike-container::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .bike-part {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        @media (max-width: 768px) {
            .bike-svg {
                max-width: 450px;
            }
        }

        @media (max-width: 480px) {
            .bike-container {
                min-height: 250px;
                padding: 10px;
            }
            
            .bike-svg {
                max-width: 400px;
            }
        }

        @media (max-width: 400px) {
            .bike-svg {
                max-width: 350px;
            }
        }

        @media (max-width: 360px) {
            .bike-container {
                min-height: 220px;
            }
            
            .bike-svg {
                max-width: 320px;
            }
        }

        @media (max-width: 320px) {
            .bike-svg {
                max-width: 280px;
            }
        }

        .bike-part.active {
            filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.6));
            animation: pulse-glow 0.3s ease-out;
        }

        @keyframes pulse-glow {
            0% {
                filter: drop-shadow(0 0 0px rgba(255, 255, 255, 0));
            }
            50% {
                filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.8));
            }
            100% {
                filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.6));
            }
        }

        .damage-dropdown {
            position: fixed;
            background: #1a1a1a;
            border: 2px solid #fff;
            border-radius: 12px;
            padding: 8px 0;
            z-index: 1000;
            max-height: 200px;
            overflow-y: auto;
            display: none;
            animation: fadeIn 0.2s ease;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }

        .damage-option {
            padding: 12px 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .damage-option:last-child {
            border-bottom: none;
        }

        .damage-option:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .damage-dropdown::-webkit-scrollbar {
            width: 6px;
        }

        .damage-dropdown::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .damage-dropdown::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .selected-damages {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 20px;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .damages-list {
            border: var(--border-width) solid var(--border-color);
            border-radius: var(--border-radius);
            min-height: 100px;
            padding: 15px;
        }

        .damage-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            animation: slideIn 0.3s ease;
        }

        .damage-item:last-child {
            border-bottom: none;
        }

        .damage-info {
            flex: 1;
        }

        .damage-part {
            font-size: 12px;
            color: #ccc;
            margin-bottom: 3px;
        }

        .damage-description {
            font-size: 14px;
            font-weight: bold;
        }

        .remove-damage {
            background: none;
            border: none;
            color: #ff4444;
            font-size: 18px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

        .remove-damage:active {
            background: rgba(255, 68, 68, 0.2);
        }

        .empty-damages {
            text-align: center;
            color: #ccc;
            font-size: 14px;
            padding: 30px 0;
        }

        .submit-section {
            text-align: center;
        }

        .submit-btn {
            height: 50px;
            padding: 0 40px;
            background: var(--primary-text);
            color: var(--primary-bg);
            border: none;
            border-radius: var(--border-radius);
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .submit-btn:active:not(:disabled) {
            transform: scale(0.98);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal.fade-out {
            animation: fadeOut 0.3s ease forwards;
        }

        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(10px); }
        }

        .modal-content {
            background: var(--primary-bg);
            border: var(--border-width) solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 20px;
            max-width: 400px;
            width: 90%;
            position: relative;
            animation: scaleIn 0.3s ease;
        }

        @keyframes scaleIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-close {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

        .modal-close:active {
            background: rgba(255, 255, 255, 0.1);
        }

        .modal-title {
            font-size: 20px;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .modal-text {
            font-size: 16px;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .modal-btn {
            display: block;
            font-weight: bold;
            width: 100%;
            height: 40px;
            background: var(--primary-text);
            color: var(--primary-bg);
            border: none;
            border-radius: var(--border-radius);
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-btn:active {
            transform: scale(0.98);
        }

        .notification {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.95);
            color: #000;
            padding: 10px 20px;
            border-radius: 8px;
            z-index: 1000;
            transition: all 0.3s ease;
            transform: translateX(100%);
            opacity: 0;
            font-size: 14px;
            font-weight: bold;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .error-message {
            color: #ff4444;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="page-title">Фиксация поломок</h1>
            <p class="page-description">Введите номер велосипеда и выберите поврежденные детали</p>
        </div>

        <div class="input-section">
            <label class="input-label">Номер велосипеда</label>
            <div class="input-wrapper">
                <input type="text" class="bike-input" id="bike-number" placeholder="20000-29030" maxlength="5">
                <button class="validate-btn" id="validate-btn">Проверить</button>
            </div>
            <div class="error-message" id="number-error">Номер должен быть от 20000 до 29030</div>
        </div>

        <div class="bike-section">
            <div class="bike-container">
                <!-- SVG велосипеда будет вставлено здесь -->
                <div id="bike-svg-container"></div>
            </div>
            <div class="damage-dropdown" id="damage-dropdown"></div>
        </div>

        <div class="selected-damages">
            <h2 class="section-title">Выбранные поломки</h2>
            <div class="damages-list" id="damages-list">
                <div class="empty-damages">Поломки не выбраны</div>
            </div>
        </div>

        <div class="submit-section">
            <button class="submit-btn" id="submit-btn" disabled>Отправить заявку</button>
        </div>
    </div>

    <!-- Модальное окно подтверждения -->
    <div class="modal" id="confirmation-modal">
        <div class="modal-content">
            <span class="modal-close" id="modal-close">&times;</span>
            <h2 class="modal-title">Заявка отправлена</h2>
            <p class="modal-text">Заявка на велосипед №<span id="bike-number-confirm"></span> успешно отправлена администратору.</p>
            <button class="modal-btn" id="modal-ok-btn">Хорошо</button>
        </div>
    </div>

    <!-- Уведомление -->
    <div class="notification" id="notification"></div>

    <script>
        let currentBikeNumber = '';
        let selectedDamages = [];
        let currentPart = null;
        let telegramWebApp = null;
        let damageData = {};

        // Инициализация Telegram Web App
        function initTelegramWebApp() {
            if (window.Telegram && window.Telegram.WebApp) {
                telegramWebApp = window.Telegram.WebApp;
                telegramWebApp.ready();
                telegramWebApp.expand();
            }
        }

        async function loadDamageData() {
            try {
                const response = await fetch('damages.json');
                const data = await response.json();
                damageData = data.parts;
                console.log('Данные о поломках загружены');
            } catch (error) {
                console.error('Ошибка загрузки данных о поломках:', error);
                // Fallback данные на случай ошибки
                damageData = {
                    "rear-wheel": ["Прокол колеса", "Восьмерка на колесе", "Износ покрышки"],
                    "front-wheel": ["Прокол колеса", "Восьмерка на колесе", "Износ покрышки"],
                    // ... остальные детали
                };
            }
        }

        function resizeBikeSVG() {
            const svg = document.querySelector('.bike-svg');
            const container = document.querySelector('.bike-container');
            
            if (svg && container) {
                const containerWidth = container.clientWidth;
                const svgNaturalWidth = 525; // Оригинальная ширина SVG
                
                // Рассчитываем масштаб
                const scale = Math.min(1, (containerWidth - 40) / svgNaturalWidth);
                
                // Применяем трансформацию
                svg.style.transform = `scale(${scale})`;
                svg.style.transformOrigin = 'center';
            }
        }

        // Вызываем при загрузке и ресайзе
        window.addEventListener('load', resizeBikeSVG);
        window.addEventListener('resize', resizeBikeSVG);

        // Загрузка SVG велосипеда
        function loadBikeSVG() {
            const svgContainer = document.getElementById('bike-svg-container');
            // В реальном приложении здесь будет загрузка SVG файла
            // Для демонстрации создаем заглушку
            svgContainer.innerHTML = `<svg width="525" height="386" viewBox="0 0 525 386" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_586_2)">

                    <!-- Заднее колесо -->
                    <g id="rear-wheel" class="bike-part">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M104.172 385.945C157.562 385.945 200.844 342.664 200.844 289.273C200.844 235.883 157.562 192.602 104.172 192.602C50.7815 192.602 7.5 235.883 7.5 289.273C7.5 342.664 50.7815 385.945 104.172 385.945ZM104.172 370.845C149.223 370.845 185.744 334.324 185.744 289.273C185.744 244.223 149.223 207.702 104.172 207.702C59.121 207.702 22.6001 244.223 22.6001 289.273C22.6001 334.324 59.121 370.845 104.172 370.845Z" fill="black"/>
                        <path d="M104.174 305.616C113.201 305.616 120.519 298.298 120.519 289.271C120.519 280.244 113.201 272.926 104.174 272.926C95.1466 272.926 87.8285 280.244 87.8285 289.271C87.8285 298.298 95.1466 305.616 104.174 305.616Z" fill="black"/>
                        <path d="M82.6743 368.066L100.109 304.864" stroke="black"/>
                        <path d="M108.867 303.973L120.698 369.355" stroke="black"/>
                        <path d="M150.953 357.167L115.114 300.905" stroke="black"/>
                        <path d="M118.843 295.848L176.457 328.944" stroke="black"/>
                        <path d="M26.6306 262.48L90.5491 280.896" stroke="black"/>
                        <path d="M89.1696 290.222L22.465 293.043" stroke="black"/>
                        <path d="M29.0682 324.479L89.7781 296.836" stroke="black"/>
                        <path d="M94.2696 301.233L53.4624 353.669" stroke="black"/>
                        <path d="M128.976 210.722L109.164 274.942" stroke="black"/>
                        <path d="M100.785 273.964L91.009 208.244" stroke="black"/>
                        <path d="M60.3889 219.479L94.4467 276.837" stroke="black"/>
                        <path d="M90.5617 281.777L34.0131 246.891" stroke="black"/>
                        <path d="M181.675 318.009L118.178 296.442" stroke="black"/>
                        <path d="M120.045 288.324L186.487 287.809" stroke="black"/>
                        <path d="M181.19 255.969L118.22 282.417" stroke="black"/>
                        <path d="M114.531 277.585L157.725 226.025" stroke="black"/>
                        <path d="M136.878 364.462L111.106 304.177" stroke="black"/>
                        <path d="M117.398 298.018L167.411 341.761" stroke="black"/>
                        <path d="M183.468 313.367L119.734 291.455" stroke="black"/>
                        <path d="M118.891 284.888L185.814 275.401" stroke="black"/>
                        <path d="M27.2345 316.851L88.6911 291.398" stroke="black"/>
                        <path d="M93.4225 299.546L43.1323 342.971" stroke="black"/>
                        <path d="M104.273 304.975L105.06 371.414" stroke="black"/>
                        <path d="M74.9825 212.579L98.8787 274.93" stroke="black"/>
                        <path d="M92.3682 279.596L43.7509 234.307" stroke="black"/>
                        <path d="M26.8117 262.181L89.2001 285.793" stroke="black"/>
                        <path d="M89.2436 292.071L23.2808 300.051" stroke="black"/>
                        <path d="M186.451 294.596L120.172 289.928" stroke="black"/>
                        <path d="M183.075 263.598L119.133 287.097" stroke="black"/>
                        <path d="M116.381 278.815L168.007 236.988" stroke="black"/>
                        <path d="M144.015 215.396L111.305 275.346" stroke="black"/>
                        <path d="M105.703 273.049L107 206.618" stroke="black"/>
                        <path d="M97.252 370.772L103.138 305.473" stroke="black"/>
                        <path d="M162.494 347.871L117.198 298.901" stroke="black"/>
                        <path d="M23.281 276.874L89.4589 283.597" stroke="black"/>
                        <path d="M22.5038 281.152L88.5663 288.927" stroke="black"/>
                        <path d="M36.7345 337.437L91.5426 299.412" stroke="black"/>
                        <path d="M96.7438 302.939L65.9403 361.811" stroke="black"/>
                        <path d="M114.758 207.696L106.381 273.926" stroke="black"/>
                        <path d="M48.8287 228.535L92.568 278.901" stroke="black"/>
                        <path d="M185.739 303.858L119.195 293.659" stroke="black"/>
                        <path d="M174.201 242.904L116.118 280.51" stroke="black"/>
                    </g>

                    <!-- Переднее колесо -->
                    <g id="front-wheel" class="bike-part">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M427.672 385.945C481.062 385.945 524.344 342.664 524.344 289.273C524.344 235.883 481.062 192.602 427.672 192.602C374.281 192.602 331 235.883 331 289.273C331 342.664 374.281 385.945 427.672 385.945ZM427.672 370.845C472.723 370.845 509.244 334.324 509.244 289.273C509.244 244.223 472.723 207.702 427.672 207.702C382.621 207.702 346.1 244.223 346.1 289.273C346.1 334.324 382.621 370.845 427.672 370.845Z" fill="black"/>
                        <path d="M406.174 368.066L423.609 304.864" stroke="black"/>
                        <path d="M432.367 303.973L444.198 369.355" stroke="black"/>
                        <path d="M474.453 357.167L438.614 300.905" stroke="black"/>
                        <path d="M442.343 295.848L499.957 328.944" stroke="black"/>
                        <path d="M350.131 262.48L414.049 280.896" stroke="black"/>
                        <path d="M412.67 290.222L345.965 293.043" stroke="black"/>
                        <path d="M352.568 324.479L413.278 296.836" stroke="black"/>
                        <path d="M417.77 301.233L376.962 353.669" stroke="black"/>
                        <path d="M452.476 210.722L432.664 274.942" stroke="black"/>
                        <path d="M424.285 273.964L414.509 208.244" stroke="black"/>
                        <path d="M383.889 219.479L417.947 276.837" stroke="black"/>
                        <path d="M414.062 281.777L357.513 246.891" stroke="black"/>
                        <path d="M505.175 318.009L441.678 296.442" stroke="black"/>
                        <path d="M443.545 288.324L509.987 287.809" stroke="black"/>
                        <path d="M504.69 255.969L441.72 282.417" stroke="black"/>
                        <path d="M438.031 277.585L481.225 226.025" stroke="black"/>
                        <path d="M460.378 364.462L434.606 304.177" stroke="black"/>
                        <path d="M440.898 298.018L490.911 341.761" stroke="black"/>
                        <path d="M506.968 313.367L443.234 291.455" stroke="black"/>
                        <path d="M442.391 284.888L509.314 275.401" stroke="black"/>
                        <path d="M350.734 316.851L412.191 291.398" stroke="black"/>
                        <path d="M416.922 299.546L366.632 342.971" stroke="black"/>
                        <path d="M427.773 304.975L428.56 371.414" stroke="black"/>
                        <path d="M398.483 212.579L422.379 274.93" stroke="black"/>
                        <path d="M415.868 279.596L367.251 234.307" stroke="black"/>
                        <path d="M350.312 262.181L412.7 285.793" stroke="black"/>
                        <path d="M412.744 292.071L346.781 300.051" stroke="black"/>
                        <path d="M509.951 294.596L443.672 289.928" stroke="black"/>
                        <path d="M506.575 263.598L442.633 287.097" stroke="black"/>
                        <path d="M439.881 278.815L491.507 236.988" stroke="black"/>
                        <path d="M467.515 215.396L434.805 275.346" stroke="black"/>
                        <path d="M429.203 273.049L430.5 206.618" stroke="black"/>
                        <path d="M420.752 370.772L426.638 305.473" stroke="black"/>
                        <path d="M485.994 347.871L440.698 298.901" stroke="black"/>
                        <path d="M346.781 276.874L412.959 283.597" stroke="black"/>
                        <path d="M346.004 281.152L412.066 288.927" stroke="black"/>
                        <path d="M360.235 337.437L415.043 299.412" stroke="black"/>
                        <path d="M420.244 302.939L389.44 361.811" stroke="black"/>
                        <path d="M438.258 207.696L429.881 273.926" stroke="black"/>
                        <path d="M372.329 228.535L416.068 278.901" stroke="black"/>
                        <path d="M509.239 303.858L442.695 293.659" stroke="black"/>
                        <path d="M497.701 242.904L439.618 280.51" stroke="black"/>
                    </g>

                    <!-- Мотор-колесос -->
                    <g id="motor" class="bike-part">
                        <path d="M427.674 304.616C436.149 304.616 443.02 297.746 443.02 289.271C443.02 280.796 436.149 273.926 427.674 273.926C419.199 273.926 412.328 280.796 412.328 289.271C412.328 297.746 419.199 304.616 427.674 304.616Z" fill="#E4E5DC" stroke="#C4B1AB" stroke-width="2"/>
                    </g>

                    <!-- Задний рекламный щит -->
                    <g id="rear-ad-sign" class="bike-part">
                        <path d="M202.5 287.599H208C208 277.1 204.6 251.802 191 234.602C174 213.102 151.5 192.601 103 191.101C64.2 189.901 35.1667 214.601 25.5 227.101H18C15.2 233.901 7.16667 239.934 3.5 242.101L0 277.599C18.5 275.099 38 278.099 48 277.599C58 277.099 77 269.102 85.5 263.602C93 258.749 103.667 258.768 108.5 259.102C114 259.481 128.668 265.604 133 272.102C137.8 279.302 146 275.766 149.5 277.599C185.9 277.999 200 284.432 202.5 287.599Z" fill="black"/>
                    </g>

                    <!-- Передний рекламный щит -->
                    <g id="front-ad-sign" class="bike-part">
                        <path d="M441.572 186.101L436.572 194.601C413.772 191.4 395.072 201.268 388.572 206.602L381.072 210.602L395.072 240.102L387.572 246.102C384.572 246.602 377.572 263.102 377.572 268.102C377.572 273.102 367.072 292.102 353.572 292.602C342.772 293.002 331.406 298.102 327.072 300.602C326.572 285.102 328.572 267.602 336.072 246.102C344.095 223.102 360.5 208.602 384.572 195.601C403.901 185.162 430.239 184.268 441.572 186.101Z" fill="black" stroke="black"/>
                    </g>

                    <!-- Замок велосипеда -->
                    <g id="lock" class="bike-part">
                        <path d="M181.663 187.855L144.663 233.355C144.163 233.022 142.863 232.055 141.663 230.855C140.463 229.655 141.163 227.689 141.663 226.855L158.663 203.355L155.663 200.355C159.663 195.689 168.063 185.855 169.663 183.855C171.263 181.855 174.663 182.689 176.163 183.355L181.663 187.855Z" fill="#2A2A2A"/>
                    </g>

                    <!-- Рама велосипеда -->
                    <g id="frame" class="bike-part">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M275.492 292.102C276.492 296.768 275.392 306.102 262.992 306.102H244.992C242.492 306.102 237.192 305.502 235.992 303.102L195.492 305.102H145.492L135.492 303.602H109.992L104.992 298.102L94.9924 296.602L93.9924 287.602L107.992 276.602L186.992 178.602L193.992 173.102L228.492 255.102C229.826 257.768 233.592 263.102 237.992 263.102H262.992L271.492 252.602C273.826 254.768 279.592 257.702 283.992 252.102C288.392 246.502 321.826 201.102 337.992 179.102C339.326 177.435 340.492 173.002 334.492 168.602L350.492 146.602C351.326 145.435 352.092 141.502 348.492 135.102L360.992 128.602L396.492 209.102L426.492 273.102C424.159 273.102 419.992 274.102 415.492 278.602C404.492 260.102 393.492 238.102 382.492 216.602C377.938 207.699 366.826 182.102 360.992 170.602L275.492 292.102ZM113.492 280.102L187.992 198.102L223.992 281.102C221.192 281.102 220.992 289.602 220.992 294.602C190.492 294.768 126.992 295.002 116.992 294.602C106.992 294.202 110.492 284.768 113.492 280.102Z" fill="#F17217"/>
                        <path d="M94.9924 296.602L93.9924 287.602C92.5 288.602 91.3138 290.102 91.4924 291.602C91.8737 294.804 93.9924 296.268 94.9924 296.602Z" fill="#F17217"/>
                        <path d="M433.309 287.602L426.5 273.102C422.5 273.102 418 275.102 415.5 278.602L426.175 293.102C432.309 297.102 435.309 293.602 433.309 287.602Z" fill="#282428"/>
                        <path d="M275.5 291.28C269.5 286.605 265.5 275.005 230 281.579" stroke="#AC5313" stroke-linecap="square"/>
                        <path d="M114.5 275.102L108.998 270.485C107.997 269.487 104.627 268.358 102.498 270.485C100.497 272.485 99.0008 274.319 97.5008 275.986C96.6675 276.819 95.5008 278.886 97.5008 280.486C99.5008 282.086 101.5 283.435 103.5 285.102" stroke="#F17217" stroke-width="2" stroke-linecap="round"/>
                    </g>

                    <!-- Цепь велосипеда -->
                    <g id="chain" class="bike-part">
                        <path d="M238 324.602C238 324.602 136.011 312.807 101 304.602" stroke="#949494" stroke-linecap="square"/>
                    </g>

                    <!-- Батарея велосипеда -->
                    <g id="battery" class="bike-part">
                        <path d="M334.5 168.602L271.5 252.5C277.1 257.3 281.854 255 284 252.102C300.167 230.268 333.5 185.302 337.5 180.102C341.5 174.902 337.167 170.268 334.5 168.602Z" fill="black"/>
                    </g>

                    <!-- Подножка велосипеда -->
                    <g id="footboard" class="bike-part">
                        <path d="M211.012 309.571C207.804 310.005 207.002 305.772 207.002 303.602H213.82C214.221 305.41 214.221 309.136 211.012 309.571Z" fill="black" stroke="black"/>
                        <path d="M206.5 312.102C213.7 312.102 215.001 306.102 211.501 304.602C211.501 304.602 208.002 305.102 210.001 307.102C212 309.102 165.601 308.102 164.001 308.102H159.001L159 313.102C159 313.102 161 312.602 167.5 312.102C174 311.602 199.3 312.102 206.5 312.102Z" fill="black" stroke="black"/>
                        <path d="M211.002 307.602C211.554 307.602 212.002 307.154 212.002 306.602C212.002 306.05 211.554 305.602 211.002 305.602C210.45 305.602 210.002 306.05 210.002 306.602C210.002 307.154 210.45 307.602 211.002 307.602Z" fill="#A9A9A9"/>
                    </g>

                    <!-- Защита цепи -->
                    <g id="chain-guard" class="bike-part">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M117.501 286.102C136.334 280.602 186.529 269.203 233.329 277.603C280.129 286.003 270.33 314.603 259.829 323.103C249.496 329.936 226.928 336.603 217.328 302.603C214.828 296.936 190.501 288.102 120.501 292.102C115.834 292.102 108.502 289.102 117.501 286.102ZM243.329 320.603C252.166 320.603 259.329 313.439 259.329 304.603C259.329 295.766 252.166 288.603 243.329 288.603C234.492 288.603 227.329 295.766 227.329 304.603C227.329 313.439 234.492 320.603 243.329 320.603Z" fill="black" stroke="black"/>
                        <path d="M117.5 290.602C118.328 290.602 119 289.93 119 289.102C119 288.274 118.328 287.602 117.5 287.602C116.672 287.602 116 288.274 116 289.102C116 289.93 116.672 290.602 117.5 290.602Z" fill="#A9A9A9"/>
                    </g>

                    <!-- Педали -->
                    <g id="pedals" class="bike-part">
                        <path d="M250 263.102L251.5 259.102H244V249.602H272L271 252.5L265.5 259L260.5 259.102L259 263.102H250Z" fill="black" fill-opacity="0.9" stroke="black"/>
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M259.5 304.602C259.5 313.438 252.337 320.602 243.5 320.602C234.663 320.602 227.5 313.438 227.5 304.602C227.5 295.765 234.663 288.602 243.5 288.602C252.337 288.602 259.5 295.765 259.5 304.602ZM243.5 312.602C247.918 312.602 251.5 309.02 251.5 304.602C251.5 300.183 247.918 296.602 243.5 296.602C239.082 296.602 235.5 300.183 235.5 304.602C235.5 309.02 239.082 312.602 243.5 312.602ZM252.5 308.102C254.5 304.902 253.333 301.102 252.5 299.602C252 297.602 254 296.602 256 298.102C257.131 298.95 258.541 307.06 255.5 310.102C253.5 312.102 252 309.102 252.5 308.102ZM243.663 315.192C247.035 315.584 249.569 313.106 250.414 311.818C251.795 310.609 253.42 311.874 253.059 314.131C252.855 315.408 246.999 319.799 243.32 318.479C240.901 317.611 242.661 315.174 243.663 315.192ZM237.733 296.619C234.229 298.02 232.926 301.775 232.713 303.478C231.935 305.387 229.731 305.013 229.003 302.621C228.591 301.268 232.243 293.891 236.494 293.233C239.289 292.8 238.727 296.107 237.733 296.619ZM233.865 307.641C234.561 311.35 237.992 313.356 239.621 313.895C241.343 315.028 240.549 317.119 238.061 317.369C236.654 317.511 230.125 312.498 230.304 308.2C230.421 305.374 233.556 306.566 233.865 307.641ZM249.956 296.782C247.303 294.098 243.336 294.358 241.685 294.824C239.623 294.85 239.111 292.673 241.031 291.072C242.118 290.167 250.334 290.663 252.593 294.323C254.079 296.73 250.814 297.499 249.956 296.782Z" fill="black" fill-opacity="0.9"/>
                        <path d="M242.5 320.602C239.163 320.602 236.064 319.58 233.5 317.832L221 348.109H210V356.609H238V348.109H230L242.5 320.602Z" fill="black" fill-opacity="0.9"/>
                        <path d="M251.5 304.602C251.5 309.02 247.918 312.602 243.5 312.602C239.082 312.602 235.5 309.02 235.5 304.602C235.5 300.183 239.082 296.602 243.5 296.602C247.918 296.602 251.5 300.183 251.5 304.602Z" fill="black"/>
                        <path d="M245 305.102C245 305.93 244.328 306.602 243.5 306.602C242.672 306.602 242 305.93 242 305.102C242 304.273 242.672 303.602 243.5 303.602C244.328 303.602 245 304.273 245 305.102Z" fill="#C8C8C8"/>
                    </g>

                    <!-- Седло велосипеда -->
                    <g id="saddle" class="bike-part">
                        <path d="M179.859 144.1C184.859 138.766 197.859 128.4 209.859 129.6C211.859 129.934 215.459 129.602 213.859 125.602C212.259 121.602 211 118.602 208.859 118.602L193.859 119.602C189.359 120.435 179.359 122.102 175.359 122.102C170.359 122.102 159.859 120.602 148.859 116.602C145.193 116.934 138.359 119.998 140.359 129.6C140.859 130.434 142.059 132.202 142.859 132.602V141.013C142.859 141.102 142.859 145.102 147.859 145.102C152.859 145.102 154.859 144.102 155.359 142.102H164.859C164.693 144.935 166.459 151.552 172.359 148.602C173.359 148.102 174.259 146.898 173.859 144.1H179.859Z" fill="black"/>
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M191.859 177.602L184.359 182.102L172.359 148.602C173.959 147.802 174.026 145.268 173.859 144.102H179.859L190.859 171.102H192.859C194.859 168.602 197.176 167.589 199.859 169.602C201.859 171.102 199.859 175.435 198.359 177.602C193.559 188.802 205.693 192.268 212.359 192.602C212.859 192.768 213.859 193.302 213.859 194.102C213.859 194.902 213.193 195.435 212.859 195.602C192.859 196.802 190.526 184.102 191.859 177.602ZM196.859 174.602C197.964 174.602 198.859 173.706 198.859 172.602C198.859 171.497 197.964 170.602 196.859 170.602C195.755 170.602 194.859 171.497 194.859 172.602C194.859 173.706 195.755 174.602 196.859 174.602Z" fill="black" stroke="black"/>
                        <path d="M197 174.602C198.381 174.602 199.5 173.483 199.5 172.102C199.5 170.721 198.381 169.602 197 169.602C195.619 169.602 194.5 170.721 194.5 172.102C194.5 173.483 195.619 174.602 197 174.602Z" fill="#A9A9A9"/>
                        <path d="M169.5 146.602C170.881 146.602 172 145.483 172 144.102C172 142.721 170.881 141.602 169.5 141.602C168.119 141.602 167 142.721 167 144.102C167 145.483 168.119 146.602 169.5 146.602Z" fill="#A9A9A9"/>
                    </g>

                    <!-- Передний фонарь велосипеда -->
                    <g id="front-light" class="bike-part">
                        <path d="M414 165.602C416.5 168.102 415 170.602 415 170.602" stroke="#BCBCBC"/>
                        <path d="M407 172.102C409 187.702 396.833 193.935 390.5 195.102L388.5 190.102C400.1 189.302 402.167 178.268 401.5 173.102L398 173.602L397 168.102L414 165.102L415 170.602L407 172.102Z" fill="black" stroke="black"/>
                    </g>

                    <!-- Световой маркер -->
                    <g id="light-marker" class="bike-part">
                        <path d="M103.317 273.57C104.815 272.068 108.317 273.57 108.317 273.57C108.317 273.57 105.315 278.069 103.317 281.07C101.32 284.07 101.82 275.071 103.317 273.57Z" fill="#980000"/>
                        <path d="M108.315 273.357L101.656 281.011C101.294 281.428 101.338 282.06 101.754 282.422L103.073 283.569C103.489 283.931 104.121 283.887 104.484 283.471L111.142 275.816C111.505 275.399 111.461 274.768 111.044 274.405L109.726 273.258C109.309 272.896 108.677 272.94 108.315 273.357Z" fill="#515151"/>
                    </g>

                    <!-- Задний светоотражатель -->
                    <g id="retroreflector" class="bike-part">
                        <path d="M18 227.224C14 225.558 5.5 226.224 3.5 242.224C8 239.602 15.6 233.226 18 227.224Z" fill="#FF0000"/>
                    </g>

                    <!-- Переключалка передач -->
                    <g id="gearshift" class="bike-part">
                        <path d="M109.053 301.977C108.556 297.465 97.5564 292.044 93.5535 298.977C89.5505 305.911 108.557 306.965 109.053 301.977Z" fill="#949494" stroke="black" stroke-width="0.4"/>
                        <path d="M107.445 298.17C105.445 294.836 99.5453 290.07 91.9453 297.67" stroke="black" stroke-width="4.4" stroke-linecap="round"/>
                        <path d="M95.5 296.668C96.3284 296.668 97 295.996 97 295.168C97 294.34 96.3284 293.668 95.5 293.668C94.6716 293.668 94 294.34 94 295.168C94 295.996 94.6716 296.668 95.5 296.668Z" fill="#A9A9A9"/>
                        <path d="M104.5 296.668C105.328 296.668 106 295.996 106 295.168C106 294.34 105.328 293.668 104.5 293.668C103.672 293.668 103 294.34 103 295.168C103 295.996 103.672 296.668 104.5 296.668Z" fill="#A9A9A9"/>
                        <path d="M93.4332 296.668C93.4332 296.668 89.9991 301.168 88.9991 302.668C87.9991 304.168 88.9991 309.102 88.9991 309.102C91.1658 312.268 94 315.102 100.933 310.102C100.933 310.102 99.9332 304.668 101.933 302.668C103.933 300.668 106.933 298.668 106.933 298.668" stroke="black" stroke-width="1.4" stroke-linecap="round"/>
                    </g>

                    <!-- Корзина велосипеда -->
                    <g id="basket" class="bike-part">
                        <path d="M377.5 171.102L354 113.602C377.333 107.269 427.6 93.4021 442 88.6021C456.4 83.8021 468 85.6021 472 87.1021L460.5 148.602C460.5 154.602 455.833 157.435 453.5 158.102L377.5 171.102Z" fill="black" stroke="black"/>
                    </g>

                    <!-- Руль велосипеда -->
                    <g id="handlebars" class="bike-part">
                    <path d="M362.049 130.568L348.549 135.068L337.049 108.066H328.049C322.049 104.066 324.882 99.7331 327.049 98.0664C331.849 97.2664 332.715 92.3997 332.549 90.0664L354.549 74.0664L359.549 81.5664C361.882 71.2331 368 56.6016 363 46.6016C361.158 42.9181 349.549 34.2331 343.549 30.5664C339.549 30.5664 335.049 29.0664 332.049 25.5664C329.649 22.7664 330.382 17.0664 331.049 14.5664L330.049 10.5664C326.549 7.06641 326.549 1.0679 332.549 0.0679011C337.349 -0.732099 339.215 5.73457 339.549 9.0679L344.049 15.0679C345.649 15.8679 347.715 20.4012 348.549 22.5679L364.049 35.0679C370.5 39.6016 371 39.6016 374.549 48.5679C378.477 58.4922 369.882 80.2346 366.049 89.5679L370.549 96.5679L367.049 100.068C369.449 102.068 369.382 108.235 369.049 111.068L357.549 116.068L362.049 130.568Z" fill="black"/>
                    </g>

                    <!-- Визуальные элементы на раме -->
                    <g id="front-ad-sign" class="bike-part">
                    <path d="M304.38 243.876L297.019 238.525L298.838 236.023C299.342 235.329 299.923 234.942 300.581 234.863C301.244 234.776 301.796 234.894 302.237 235.215C302.546 235.439 302.776 235.719 302.929 236.055C303.074 236.385 303.132 236.711 303.102 237.033L303.123 237.048C303.56 236.712 304.051 236.522 304.597 236.48C305.135 236.432 305.657 236.591 306.161 236.958C306.729 237.371 307.067 237.953 307.173 238.706C307.273 239.453 307.055 240.195 306.52 240.931L304.38 243.876ZM300.887 239.682L301.797 238.43C302.036 238.101 302.145 237.752 302.124 237.383C302.108 237.007 301.932 236.696 301.596 236.452C301.259 236.207 300.909 236.135 300.547 236.236C300.19 236.33 299.891 236.542 299.652 236.871L298.742 238.122L300.887 239.682ZM304.242 242.12L305.495 240.395C305.796 239.982 305.931 239.56 305.9 239.131C305.862 238.696 305.661 238.346 305.297 238.081C304.925 237.811 304.53 237.728 304.112 237.831C303.688 237.93 303.325 238.185 303.024 238.599L301.771 240.324L304.242 242.12ZM311.08 234.922C310.566 235.63 309.872 236.069 308.999 236.238C308.124 236.395 307.277 236.175 306.457 235.579C305.65 234.993 305.173 234.271 305.025 233.414C304.87 232.551 305.042 231.776 305.542 231.089C306.031 230.416 306.695 230.004 307.533 229.853C308.365 229.696 309.278 229.98 310.273 230.703L310.421 230.81L307.562 234.743C308.066 235.024 308.562 235.1 309.05 234.973C309.537 234.834 309.928 234.561 310.224 234.155C310.387 233.93 310.511 233.678 310.597 233.398C310.681 233.105 310.71 232.794 310.682 232.463L311.808 232.285C311.872 232.728 311.838 233.18 311.706 233.641C311.579 234.095 311.371 234.522 311.08 234.922ZM306.792 234.167L308.84 231.349C308.469 231.122 308.052 231.033 307.588 231.082C307.129 231.123 306.76 231.337 306.479 231.722C306.184 232.129 306.078 232.561 306.163 233.02C306.253 233.471 306.463 233.853 306.792 234.167ZM313.563 231.463C313.486 231.568 313.396 231.663 313.291 231.748C313.192 231.825 313.131 231.872 313.109 231.888L312.215 231.239C312.232 231.23 312.265 231.206 312.315 231.167C312.365 231.128 312.413 231.077 312.458 231.014C312.632 230.776 312.624 230.513 312.436 230.226C312.253 229.933 311.914 229.574 311.419 229.149C311.082 228.862 310.753 228.585 310.431 228.319C310.108 228.041 309.826 227.804 309.583 227.606C309.334 227.404 309.135 227.243 308.986 227.124C308.835 226.993 308.759 226.927 308.759 226.927L311.312 223.415L316.507 227.191L315.75 228.232L311.407 225.075L310.276 226.631C310.523 226.822 310.818 227.057 311.16 227.338C311.503 227.619 311.839 227.901 312.169 228.184C312.92 228.816 313.428 229.399 313.693 229.934C313.958 230.47 313.914 230.979 313.563 231.463ZM319.425 223.442C318.905 224.157 318.206 224.581 317.327 224.714C316.448 224.846 315.613 224.625 314.821 224.049C314.029 223.473 313.56 222.747 313.415 221.87C313.27 220.994 313.458 220.198 313.977 219.483C314.497 218.768 315.196 218.344 316.075 218.211C316.954 218.078 317.789 218.3 318.581 218.875C319.373 219.451 319.842 220.177 319.987 221.054C320.132 221.931 319.944 222.727 319.425 223.442ZM318.51 222.777C318.841 222.321 318.943 221.827 318.815 221.295C318.68 220.758 318.35 220.299 317.824 219.916C317.306 219.539 316.77 219.37 316.218 219.408C315.665 219.445 315.223 219.692 314.892 220.148C314.561 220.603 314.463 221.1 314.597 221.637C314.732 222.174 315.059 222.631 315.577 223.008C316.103 223.39 316.642 223.562 317.195 223.525C317.74 223.482 318.178 223.233 318.51 222.777ZM323.933 217.238C323.373 218.009 322.634 218.437 321.716 218.52C320.792 218.598 319.839 218.28 318.857 217.567L318.689 217.444C318.114 217.026 317.601 216.583 317.148 216.115C316.696 215.647 316.36 215.151 316.14 214.627C315.926 214.097 315.858 213.527 315.935 212.919C316.013 212.312 316.291 211.656 316.769 210.954C317.002 210.62 317.191 210.307 317.337 210.017C317.477 209.722 317.547 209.5 317.549 209.351L318.474 210.024C318.473 210.173 318.402 210.395 318.263 210.69C318.116 210.98 317.927 211.292 317.694 211.627C317.08 212.53 316.868 213.302 317.056 213.943C317.242 214.571 317.659 215.184 318.305 215.783L318.321 215.762C318.203 215.409 318.179 215.006 318.251 214.554C318.315 214.097 318.492 213.669 318.783 213.269C319.262 212.61 319.915 212.212 320.744 212.075C321.565 211.933 322.368 212.147 323.153 212.718C323.945 213.293 324.403 214.012 324.527 214.873C324.656 215.728 324.458 216.516 323.933 217.238ZM323.043 216.607C323.364 216.165 323.47 215.68 323.361 215.151C323.253 214.622 322.939 214.169 322.42 213.792C321.909 213.42 321.385 213.264 320.848 213.324C320.312 213.384 319.883 213.635 319.562 214.077C319.241 214.518 319.135 215.004 319.243 215.533C319.351 216.061 319.662 216.512 320.173 216.884C320.692 217.261 321.22 217.419 321.756 217.359C322.293 217.299 322.722 217.048 323.043 216.607ZM327.091 211.081C327.345 210.731 327.448 210.339 327.398 209.907C327.346 209.462 327.11 209.087 326.69 208.781L326.427 208.59C326.293 208.729 326.159 208.877 326.022 209.035C325.886 209.193 325.775 209.332 325.688 209.451C325.362 209.9 325.193 210.302 325.181 210.658C325.162 211.008 325.286 211.28 325.552 211.474C325.762 211.626 326.013 211.68 326.303 211.634C326.594 211.588 326.856 211.404 327.091 211.081ZM327.8 211.918C327.418 212.444 326.941 212.762 326.369 212.871C325.789 212.975 325.265 212.856 324.795 212.515C324.368 212.204 324.106 211.746 324.01 211.141C323.92 210.528 324.17 209.815 324.761 209.002C324.868 208.855 325.001 208.694 325.159 208.52C325.316 208.334 325.472 208.164 325.627 208.009L325.354 207.81C325.032 207.576 324.71 207.503 324.389 207.591C324.068 207.679 323.79 207.884 323.555 208.206C323.362 208.473 323.225 208.764 323.145 209.081C323.064 209.398 323.021 209.671 323.014 209.902L321.888 210.08C321.861 209.675 321.912 209.251 322.041 208.809C322.167 208.355 322.376 207.928 322.666 207.528C323.14 206.876 323.69 206.488 324.316 206.364C324.946 206.234 325.563 206.387 326.166 206.825L329.531 209.271L328.797 210.281L328.23 209.868L328.214 209.889C328.313 210.196 328.328 210.529 328.26 210.887C328.193 211.245 328.04 211.589 327.8 211.918ZM330.597 207.806L325.402 204.03L326.151 202.999L329.705 205.583L329.72 205.562L327.924 200.56L328.604 199.624L333.799 203.399L333.05 204.43L329.506 201.854L329.491 201.875L331.277 206.87L330.597 207.806ZM326.349 201.311C326.023 201.76 325.655 202.06 325.244 202.212C324.832 202.352 324.514 202.421 324.291 202.419L324.14 201.409C324.312 201.395 324.534 201.332 324.808 201.22C325.075 201.103 325.298 200.922 325.476 200.677C325.655 200.432 325.758 200.164 325.787 199.874C325.808 199.579 325.8 199.348 325.761 199.18L326.767 199.012C326.838 199.224 326.868 199.551 326.857 199.993C326.845 200.423 326.675 200.863 326.349 201.311ZM334.903 201.88L329.709 198.104L330.458 197.074L332.571 198.61L333.183 197.769L332.093 194.823L332.934 193.667L334.155 197.094L338.366 197.116L337.441 198.389L334.088 198.314L333.423 199.229L335.652 200.85L334.903 201.88Z" fill="black"/>
                    <path d="M155.495 302.678L151.879 302.692L151.877 302.06L153.288 300.647C153.814 300.117 154.17 299.718 154.355 299.451C154.546 299.183 154.641 298.922 154.64 298.666C154.639 298.383 154.54 298.157 154.342 297.987C154.144 297.817 153.898 297.732 153.605 297.734C153.312 297.735 153.042 297.802 152.798 297.937C152.553 298.066 152.348 298.205 152.183 298.355L151.661 297.837C151.847 297.639 152.113 297.448 152.459 297.266C152.805 297.083 153.186 296.991 153.602 296.99C154.205 296.987 154.667 297.154 154.988 297.488C155.309 297.818 155.471 298.191 155.472 298.607C155.474 298.991 155.358 299.351 155.124 299.688C154.891 300.019 154.559 300.397 154.128 300.82L152.997 301.936V301.952L155.757 301.942L155.495 302.678ZM156.412 302.675L156.409 301.939L157.593 301.935L157.577 297.807L156.481 297.811L156.479 297.075L158.375 297.068L158.393 301.932L159.665 301.927L159.364 302.664L156.412 302.675ZM162.192 302.749C161.526 302.752 161.005 302.492 160.629 301.971C160.254 301.445 160.065 300.741 160.061 299.861C160.058 298.987 160.242 298.285 160.613 297.755C160.985 297.226 161.504 296.96 162.171 296.957C162.837 296.955 163.358 297.217 163.733 297.744C164.109 298.27 164.298 298.971 164.301 299.845C164.305 300.725 164.121 301.43 163.749 301.959C163.378 302.484 162.859 302.747 162.192 302.749ZM162.189 302.013C162.611 302.012 162.927 301.813 163.139 301.418C163.356 301.022 163.464 300.499 163.461 299.849C163.459 299.198 163.348 298.676 163.127 298.282C162.913 297.888 162.595 297.692 162.173 297.693C161.752 297.695 161.433 297.893 161.216 298.289C161.004 298.684 160.899 299.208 160.901 299.858C160.904 300.509 161.012 301.031 161.227 301.425C161.447 301.819 161.768 302.015 162.189 302.013ZM167.015 302.731C166.615 302.733 166.244 302.667 165.902 302.535C165.565 302.398 165.282 302.215 165.052 301.987L165.594 301.441C165.786 301.616 165.998 301.754 166.227 301.854C166.457 301.949 166.713 301.996 166.996 301.995C167.332 301.994 167.619 301.897 167.859 301.704C168.103 301.506 168.225 301.244 168.224 300.919C168.222 300.572 168.085 300.309 167.813 300.128C167.54 299.948 167.212 299.858 166.828 299.86C166.753 299.86 166.678 299.863 166.604 299.869C166.529 299.874 166.457 299.883 166.388 299.894L166.386 299.39L167.996 297.768L165.372 297.777L165.369 297.041L168.937 297.028L168.94 297.676L167.441 299.186V299.202C167.905 299.253 168.29 299.436 168.595 299.749C168.906 300.057 169.062 300.444 169.064 300.908C169.066 301.414 168.87 301.844 168.477 302.198C168.083 302.551 167.596 302.729 167.015 302.731ZM172.184 302.712C171.518 302.714 170.997 302.455 170.621 301.934C170.246 301.407 170.057 300.704 170.054 299.824C170.05 298.949 170.234 298.247 170.606 297.718C170.977 297.188 171.496 296.922 172.163 296.92C172.829 296.917 173.35 297.179 173.726 297.706C174.101 298.233 174.29 298.933 174.293 299.808C174.297 300.688 174.113 301.393 173.741 301.922C173.37 302.446 172.851 302.709 172.184 302.712ZM172.182 301.976C172.603 301.974 172.92 301.776 173.131 301.38C173.349 300.985 173.456 300.462 173.453 299.811C173.451 299.16 173.34 298.638 173.12 298.244C172.905 297.85 172.587 297.654 172.165 297.656C171.744 297.657 171.425 297.856 171.208 298.251C170.996 298.647 170.891 299.17 170.894 299.821C170.896 300.471 171.005 300.994 171.219 301.387C171.44 301.781 171.76 301.977 172.182 301.976Z" fill="black"/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M301.478 249.652C300.539 247.189 299.305 243.95 297.715 242.811C295.811 241.448 293.161 241.844 291.795 243.694C290.43 245.545 290.866 248.149 292.77 249.513C294.61 250.829 299.09 250.933 301.727 250.994L302 251C301.837 250.596 301.663 250.139 301.478 249.652ZM295.105 248.626C296.557 248.626 297.733 247.467 297.733 246.038C297.733 244.607 296.557 243.449 295.105 243.449C293.653 243.449 292.477 244.607 292.477 246.038C292.477 247.467 293.653 248.626 295.105 248.626Z" fill="black"/>
                    <path d="M297.43 245.752C297.353 245.152 297.038 244.606 296.554 244.234C296.07 243.863 295.457 243.696 294.848 243.77C294.846 243.77 294.843 243.769 294.841 243.769C294.839 243.77 294.837 243.771 294.834 243.772C294.226 243.847 293.673 244.158 293.296 244.636C292.92 245.113 292.75 245.719 292.825 246.319C292.825 246.322 292.824 246.324 292.825 246.326C292.825 246.328 292.827 246.33 292.827 246.333C292.904 246.933 293.219 247.479 293.703 247.85C294.187 248.222 294.8 248.389 295.409 248.315C295.411 248.315 295.414 248.316 295.416 248.316C295.419 248.315 295.421 248.314 295.423 248.313C296.031 248.237 296.584 247.927 296.961 247.449C297.338 246.972 297.507 246.366 297.432 245.766C297.432 245.764 297.433 245.761 297.433 245.759C297.432 245.756 297.431 245.755 297.43 245.752ZM294.224 247.595L294.954 246.67L295.101 247.832C294.793 247.828 294.491 247.747 294.224 247.595ZM293.377 246.509L294.555 246.364L293.826 247.289C293.611 247.071 293.457 246.803 293.377 246.509ZM296.033 244.49L295.304 245.415L295.157 244.253C295.465 244.257 295.766 244.338 296.033 244.49ZM294.803 245.477L293.865 244.757C294.086 244.545 294.358 244.393 294.656 244.314L294.803 245.477ZM294.493 245.87L293.314 246.015C293.319 245.711 293.401 245.413 293.555 245.15L294.493 245.87ZM295.454 246.608L296.392 247.328C296.171 247.54 295.899 247.692 295.602 247.771L295.454 246.608ZM295.764 246.215L296.943 246.07C296.939 246.374 296.856 246.672 296.702 246.935L295.764 246.215ZM295.702 245.721L296.432 244.796C296.646 245.014 296.801 245.282 296.88 245.576L295.702 245.721Z" fill="black"/>
                    </g>

                    <!-- Блок троса -->
                    <g id="cable-block" class="bike-part">
                    <path d="M345.001 164.602L340.301 160.602L348.67 149.102L353.501 153.102L345.001 164.602Z" fill="black"/>
                    </g>

                    </g>
                    <defs>
                    <clipPath id="clip0_586_2">
                    <rect width="525" height="386" fill="white"/>
                    </clipPath>
                    </defs>
                    </svg>
            `;
            
            // После загрузки SVG добавляем обработчики для деталей
            setTimeout(() => {
                setupBikePartsInteractivity();
            }, 100);
        }

        // Настройка интерактивности деталей велосипеда
        function setupBikePartsInteractivity() {
            const parts = document.querySelectorAll('.bike-part');
            parts.forEach(part => {
                part.addEventListener('click', handlePartClick);
            });
        }

        // Обработчик клика на деталь
        function handlePartClick(event) {

            const partId = event.currentTarget.id;
            currentPart = partId;
            
            // Подсвечиваем выбранную деталь
            document.querySelectorAll('.bike-part').forEach(p => p.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            // Показываем выпадающий список поломок
            showDamageDropdown(partId, event.currentTarget);
        }

        // Показать выпадающий список поломок
        function showDamageDropdown(partId, partElement) {
            const dropdown = document.getElementById('damage-dropdown');
            const rect = partElement.getBoundingClientRect();
            const viewport = {
                width: window.innerWidth,
                height: window.innerHeight
            };
            
            // Рассчитываем позицию
            let left = rect.left;
            let top = rect.bottom + 5;
            
            // Настройки dropdown
            const dropdownWidth = Math.min(280, viewport.width - 40);
            const dropdownMaxHeight = 200;
            
            // Проверяем правый край
            if (left + dropdownWidth > viewport.width - 10) {
                left = viewport.width - dropdownWidth - 10;
            }
            
            // Проверяем левый край
            if (left < 10) {
                left = 10;
            }
            
            // Проверяем нижний край - если не помещается вниз, показываем сверху
            const estimatedHeight = Math.min(dropdownMaxHeight, (damageData[partId]?.length || 0) * 40 + 20);
            if (top + estimatedHeight > viewport.height - 10) {
                top = rect.top - estimatedHeight - 5;
            }
            
            dropdown.style.left = left + 'px';
            dropdown.style.top = top + 'px';
            dropdown.style.width = dropdownWidth + 'px';
            dropdown.style.maxHeight = dropdownMaxHeight + 'px';
            dropdown.style.display = 'block';
            dropdown.style.zIndex = '1000';
            
            // Заполняем список поломок
            const damages = damageData[partId] || [];
            dropdown.innerHTML = '';
            
            if (damages.length === 0) {
                dropdown.innerHTML = '<div class="damage-option">Нет данных о поломках</div>';
                return;
            }
            
            damages.forEach(damage => {
                const option = document.createElement('div');
                option.className = 'damage-option';
                option.textContent = damage;
                option.addEventListener('click', () => selectDamage(damage, partId));
                dropdown.appendChild(option);
            });
            
            // Закрытие при клике вне списка
            setTimeout(() => {
                document.addEventListener('click', closeDropdownOnClickOutside);
            }, 10);
        }

        // Закрыть выпадающий список при клике вне
        function closeDropdownOnClickOutside(event) {
            const dropdown = document.getElementById('damage-dropdown');
            if (!dropdown.contains(event.target) && !event.target.closest('.bike-part')) {
                dropdown.style.display = 'none';
                document.querySelectorAll('.bike-part').forEach(p => p.classList.remove('active'));
                document.removeEventListener('click', closeDropdownOnClickOutside);
            }
        }

        // Выбор поломки
        function selectDamage(damage, partId) {
            const damageId = Date.now(); // Уникальный ID для поломки
            
            selectedDamages.push({
                id: damageId,
                part: partId,
                description: damage
            });
            
            updateDamagesList();
            updateSubmitButton();
            
            // Закрываем выпадающий список
            document.getElementById('damage-dropdown').style.display = 'none';
            document.querySelectorAll('.bike-part').forEach(p => p.classList.remove('active'));
            document.removeEventListener('click', closeDropdownOnClickOutside);
            
            showNotification('Поломка добавлена');
        }

        // Обновление списка выбранных поломок
        function updateDamagesList() {
            const list = document.getElementById('damages-list');
            
            if (selectedDamages.length === 0) {
                list.innerHTML = '<div class="empty-damages">Поломки не выбраны</div>';
                return;
            }
            
            list.innerHTML = '';
            selectedDamages.forEach(damage => {
                const item = document.createElement('div');
                item.className = 'damage-item';
                item.innerHTML = `
                    <div class="damage-info">
                        <div class="damage-part">${getPartName(damage.part)}</div>
                        <div class="damage-description">${damage.description}</div>
                    </div>
                    <button class="remove-damage" data-id="${damage.id}">×</button>
                `;
                list.appendChild(item);
            });
            
            // Добавляем обработчики для кнопок удаления
            document.querySelectorAll('.remove-damage').forEach(btn => {
                btn.addEventListener('click', removeDamage);
            });
        }

        // Удаление поломки
        function removeDamage(event) {
            const damageId = parseInt(event.target.getAttribute('data-id'));
            selectedDamages = selectedDamages.filter(damage => damage.id !== damageId);
            updateDamagesList();
            updateSubmitButton();
            showNotification('Поломка удалена');
        }

        // Получение читаемого названия детали
        function getPartName(partId) {
            const partNames = {
                'rear-wheel': 'Заднее колесо',
                'front-wheel': 'Переднее колесо',
                'rear-wheel': 'Мотор-колесо',
                'motor': 'Мотор-колесо',
                'rear-ad-sign': 'Задний рекламный щит',
                'front-ad-sign': 'Передний рекламный щит',
                'lock': 'Замок-подкова',
                'frame': 'Рама',
                'chain': 'Цепь',
                'battery': 'Батарея',
                'footboard': 'Подножка',
                'saddle': 'Седло',
                'handlebars': 'Руль',
                'pedals': 'Педали',
                'chain-guard': 'Защита цепи',
                'light-marker': 'Световой маркер',
                'retroreflector': 'Задний светоотражатель',
                'gearshift': 'Переключалка передач',
                'basket': 'Корзина',
                'cable-block': 'Блок троса',
                'front-light': 'Передний фонарь'
            };
            
            return partNames[partId] || partId;
        }

        // Обновление состояния кнопки отправки
        function updateSubmitButton() {
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.disabled = !currentBikeNumber || selectedDamages.length === 0;
        }

        // Валидация номера велосипеда
        function validateBikeNumber(number) {
            const num = parseInt(number);
            return !isNaN(num) && num >= 20000 && num <= 29030;
        }

        // Показать уведомление
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            
            // Удаляем существующее уведомление
            const existingNotification = document.querySelector('.notification.show');
            if (existingNotification) {
                existingNotification.classList.remove('show');
            }
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Отправка данных админу
        async function sendReportToAdmin() {
            const bikeNumber = document.getElementById('bike-number').value.trim();
            const numberError = document.getElementById('number-error');
            
            // ВАЛИДАЦИЯ НОМЕРА ПЕРЕД ОТПРАВКОЙ
            if (!validateBikeNumber(bikeNumber)) {
                numberError.style.display = 'block';
                document.getElementById('bike-number').style.borderColor = '#ff4444';
                showNotification('Введите корректный номер велосипеда (20000-29030)');
                return;
            }
            
            // Проверяем, что есть поломки
            if (selectedDamages.length === 0) {
                showNotification('Выберите хотя бы одну поломку');
                return;
            }
            
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Отправка...';
            
            try {
                const report = {
                    bikeNumber: currentBikeNumber,
                    damages: selectedDamages,
                    timestamp: new Date().toISOString(),
                    user: telegramWebApp ? telegramWebApp.initDataUnsafe.user : null
                };
                
                // Формируем текст сообщения для админа
                let messageText = `<b>Новая заявка на ремонт</b>\n`;
                messageText += `<b>Велосипед:</b> №${report.bikeNumber}\n`;
                messageText += `<b>Время:</b> ${new Date().toLocaleString()}\n\n`;
                messageText += `<b>Список поломок:</b>\n`;
                
                report.damages.forEach((damage, index) => {
                    messageText += `${index + 1}. <i>${getPartName(damage.part)}</i>: ${damage.description}\n`;
                });
                
                // Отправка через Telegram Bot API в тему группы
                const botToken = '8201906085:AAF7GhKDhy4NpjOD9QEO05ddR8hQM8X2lEw'; // Замени на реальный токен бота
                const chatId = '-1002981629310'; // Замени на ID группы
                const messageThreadId = 11; // ID темы в группе
                
                const response = await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: chatId,
                        message_thread_id: messageThreadId, // Отправка в конкретную тему
                        text: messageText,
                        parse_mode: 'HTML'
                    })
                });
                
                const result = await response.json();
                
                if (response.ok && result.ok) {
                    showConfirmationModal();
                } else {
                    throw new Error(result.description || 'Ошибка отправки');
                }
                
            } catch (error) {
                console.error('Ошибка отправки:', error);
                showNotification('Ошибка отправки заявки: ' + error.message);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Отправить заявку';
            }
        }

        // Показать модальное окно подтверждения
        function showConfirmationModal() {
            const modal = document.getElementById('confirmation-modal');
            const bikeNumberConfirm = document.getElementById('bike-number-confirm');
            
            bikeNumberConfirm.textContent = currentBikeNumber;
            modal.classList.add('active');
        }

        // Скрыть модальное окно
        function hideModal(modal) {
            modal.classList.add('fade-out');
            setTimeout(() => {
                modal.classList.remove('active');
                modal.classList.remove('fade-out');
                
                // Сбрасываем форму после успешной отправки
                if (modal.id === 'confirmation-modal') {
                    resetForm();
                }
            }, 300);
        }

        // Сброс формы
        function resetForm() {
            currentBikeNumber = '';
            selectedDamages = [];
            document.getElementById('bike-number').value = '';
            updateDamagesList();
            updateSubmitButton();
            document.querySelectorAll('.bike-part').forEach(p => p.classList.remove('active'));
        }

        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            initTelegramWebApp();
            loadBikeSVG();
            loadDamageData();
            resizeBikeSVG();

            // Обработчики для поля ввода номера
            const bikeInput = document.getElementById('bike-number');
            const validateBtn = document.getElementById('validate-btn');
            const numberError = document.getElementById('number-error');
            const submitBtn = document.getElementById('submit-btn');
            
            validateBtn.addEventListener('click', function() {
                const number = bikeInput.value.trim();
                
                if (validateBikeNumber(number)) {
                    currentBikeNumber = number;
                    numberError.style.display = 'none';
                    bikeInput.style.borderColor = 'var(--border-color)';
                    showNotification(`Номер ${number} подтвержден`);
                    updateSubmitButton();
                } else {
                    numberError.style.display = 'block';
                    bikeInput.style.borderColor = '#ff4444';
                }
            });
            
            bikeInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    validateBtn.click();
                }
            });
            
            bikeInput.addEventListener('input', function() {
                numberError.style.display = 'none';
                bikeInput.style.borderColor = 'var(--border-color)';
                currentBikeNumber = '';
                updateSubmitButton();
            });
            
            // Обработчик отправки формы
            submitBtn.addEventListener('click', sendReportToAdmin);
            
            // Обработчики модального окна
            const modal = document.getElementById('confirmation-modal');
            const modalClose = document.getElementById('modal-close');
            const modalOk = document.getElementById('modal-ok-btn');
            
            modalClose.addEventListener('click', () => hideModal(modal));
            modalOk.addEventListener('click', () => hideModal(modal));
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) hideModal(modal);
            });
        });
    </script>
</body>
</html>
